import math
import sys
import os
import numpy as np
from scipy.optimize import curve_fit
import telescope_sensitivity as ts
import pyfits
from astropy.coordinates import SkyCoord
import matplotlib.pyplot as plt
from matplotlib import rc
from astropy.io import fits
import astropy.wcs as wcs
rc('text', usetex=True)
font = {'weight' : 'normal','size':12,'family':'sans-serif','sans-serif':['Helvetica']}
rc('font', **font)

lletter = ['a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z']

def multigaus(x, *params):
    y = np.zeros_like(x)
    for i in range(0, len(params), 3):
        x0 = params[i] # i-th line center
        a = params[i+1] # i-th line amplitude
        sigma = params[i+2] # i-th line sigma
        y = y + a * np.exp(-(x-x0)**2/(2.*sigma**2))
    return y

def cuberms(cube,velaxis=0): # given a ppv cube, where axes order vel, y, x, estimate cube rms in emission free channels
    stdplane = [(1,2),(0,2),(0,1)]
    planerms = np.nanstd(cube,axis=stdplane[velaxis]) # calculate standard deviation along y z axes, which will give std in each xplane 
    rms = np.nanmin(planerms[np.nonzero(planerms)]) # get rms for all velocity planes, the minimum rms is used as cube rms 
    print 'cube rms = ',rms
    return rms

def beampixel(bmaj,bmin,bpa,corecenter,cellsize,beamfraction=1.): # bmaj, bmin, cellsize in arcsec, corecenter = [pixelx, pixely], input bpa in degree
    pixellist = []
    rotation = float(bpa)/180.*np.pi
    cosa = np.cos(rotation)
    sina = np.sin(rotation)
    squareradius = int(bmaj/cellsize) # define a search domain first, make it twice bmaj
    xcenter,ycenter = corecenter
    semimajor = bmaj/2./cellsize*beamfraction**0.5
    semiminor = bmin/2./cellsize*beamfraction**0.5
    for x in range(xcenter-squareradius,xcenter+squareradius+1):
        for y in range(ycenter-squareradius,ycenter+squareradius+1):
            if ((x-xcenter)*cosa+(y-ycenter)*sina)**2/semimajor**2 + ((x-xcenter)*sina-(y-ycenter)*cosa)**2/semiminor**2 < 1.:
                pixellist.append((x,y))
    return pixellist

def mom0(deltav,intens):
    """calculate 0th moment of input vel weighted by intens, both should be 1d list or array"""
    return sum([deltav*intens[i] for i in range(len(intens))])

def mom1(rawvel,rawintens,thres):
    """calculate first moment of input vel weighted by intens, both should be 1d list or array"""
    if len(rawvel) != len(rawintens):
        print 'input have different size'
        return False
    usedata = (rawintens>thres)
    vel = rawvel[usedata]
    intens = rawintens[usedata]
    return sum([vel[i]*intens[i] for i in range(len(vel))])/sum(intens)

def mom2(rawvel,rawintens,thres):
    """calculate second moment of input vel weighted by intens, both should be 1d list or array"""
    if len(rawvel) != len(rawintens):
        print 'input have different size'
        return False
    usedata = (rawintens>thres)
    vel = rawvel[usedata]
    intens = rawintens[usedata]
    mmom1 = mom1(vel,intens,thres)
    return (sum([intens[i]*(vel[i]-mmom1)**2 for i in range(len(vel))])/sum(intens))**0.5

def sk_peaks(arr,sen):
    """
    return indices of peaks of arr
    sens is how many steps for defining a peak
    """
    ind=[]
    j=0
    k=0
    sens=sen
    for i in range(1,len(arr)):
        if arr[i] > arr[i-1]:
            if k == 0:
                j=j+1
            if k > 0:
                if j == 0:
                    k=0
                else:
                    if k >= sens:
                        ind.append(i-k-1)
                    j=0
                    k=0
        else:
            k=k+1
            if j < sens:
                j=0
        if i == len(arr)-1 and k >= sens and j >= sens:
            ind.append(i-k)
#    print 'peak numbers '+str(len(ind))
    return np.array(ind)

######################## get singleGaus dict
#corenames,corevelocities_12CO,coresnr_12CO,coremom0s_12CO,coremom1s_12CO,coremom2s_12CO,corevelocities_13CO,coresnr_13CO,coremom0s_13CO,coremom1s_13CO,coremom2s_13CO,corevelocities_C18O,coresnr_C18O,coremom0s_C18O,coremom1s_C18O,coremom2s_C18O = np.loadtxt('Lanecores_velocities.txt',unpack=True,dtype='string')
#print "singleGaussDict = {"
#for jj in range(len(corenames)):
#    if float(corevelocities_13CO[jj]) == -100. or float(corevelocities_13CO[jj]) == 0. or float(corevelocities_C18O[jj]) == -100. or float(corevelocities_C18O[jj]) == 0.:
#        print "                   '"+corenames[jj]+"':{'13CO':[8.],'C18O':[8.]}," 
#    else:
#        print "                   '"+corenames[jj]+"':{'13CO':["+corevelocities_13CO[jj]+"],'C18O':["+corevelocities_C18O[jj]+"]}," 
#print "                  }"
#sys.exit()

########################
corenames, xw, yw, peak850, flux850, cmaj, cmin, cpa = np.loadtxt('/Users/shuokong/GoogleDrive/OrionAdust/Lane2016/Getsources_cores_degree.txt',usecols=(0,1,2,3,4,5,6,7),unpack=True)
#corenames, xw, yw, peak850, flux850, cmaj, cmin, cpa = np.loadtxt('/Users/shuokong/GoogleDrive/OrionAdust/Lane2016/test.txt',usecols=(0,1,2,3,4,5,6,7),unpack=True)
print 'minimum cmaj',min(cmaj),'minimum cmin',min(cmin)
print 'maximum cmaj',max(cmaj),'maximum cmin',max(cmin)
worldcoord = np.stack((xw,yw,np.zeros_like(xw),np.zeros_like(xw)),axis=1)
#worldcoord = np.stack((xw,yw,np.zeros_like(xw)),axis=1)

cellsize = 2. # voxel size in arcsec
lines = ['/Users/shuokong/GoogleDrive/12co/products/mask_imfit_12co_pix_2_Tmb.fits','/Users/shuokong/GoogleDrive/13co/products/mask_imfit_13co_pix_2_Tmb.fits','/Users/shuokong/GoogleDrive/c18o/products/mask_imfit_c18o_pix_2_Tmb.fits']
#lines = ['/Users/shuokong/GoogleDrive/Alyssa/nostokes_mask_imfit_12co_pix_2_Tmb.fits','/Users/shuokong/GoogleDrive/Alyssa/regrid_12co_specsmooth_0p25_mask_imfit_13co_pix_2_Tmb.fits','/Users/shuokong/GoogleDrive/Alyssa/regrid_12co_specsmooth_0p25_mask_imfit_c18o_pix_2_Tmb.fits']
linebeams = []
linedata = []
linerms = []
linefreq = [115.27120180,110.20135430,109.78217340]
linexx = []
lineyy = []
line3rdaxis = []
print 'getting line cube metadata'
for j in range(len(lines)):
    print lines[j]
    hdulist = pyfits.open(lines[j])
    header = hdulist[0].header
    del header['HISTORY']
    w = wcs.WCS(header)
    scidata = hdulist[0].data[0,:,:,:] # remove stokes, usually index order: v, dec, ra
    #scidata = hdulist[0].data[:,:,:] # usually index order: v, dec, ra
    n1,n2,n3 = scidata.shape
    linedata.append(scidata) 
    bmaj = header['BMAJ']*3600. # convert to arcsec
    bmin = header['BMIN']*3600.
    bpa = header['BPA']
    crval3 = header['CRVAL3']
    cdelt3 = header['CDELT3']
    crpix3 = header['CRPIX3']
    line3rdaxis.append([crval3, cdelt3, crpix3, n1])
    #linebeams.append([bmaj,bmin,bpa]) 
    #datarms = cuberms(scidata)
    #print 'datarms',datarms
    #linerms.append(datarms)
    pixcoord = w.all_world2pix(worldcoord,1) # FITS standard uses 1
    xx = pixcoord[:,0]
    yy = pixcoord[:,1]
    linexx.append(xx)
    lineyy.append(yy)
    hdulist.close()
print 'finish getting line cube metadata'
linebeams = [[10.010999813688, 8.091999962928, -12.8900003433], [7.620999868944001, 6.155000813304, 9.93999958038], [10.499000083668, 7.742001023136, -0.40000000596]]
linerms = [1.1954995, 1.093392, 0.7671435]
#linebeams = [[10.010999813688, 8.091999962928, -12.8900003433], [10.000000242144, 8.000000193707999, -13.0000019073], [10.499000083668, 7.742001023136, -0.40000000596]]
#linerms = [1.1954995, 0.4386849, 0.44249624]
print 'linebeams',linebeams
print 'linerms',linerms
#sys.exit()

worldcoord = np.stack((xw,yw),axis=1)
nh3file = '/Users/shuokong/GoogleDrive/AncillaryData/GBT/OrionA_Vlsr_DR1_rebase3_flag.fits'
print nh3file
hdulist = pyfits.open(nh3file)
header = hdulist[0].header
del header['HISTORY']
w = wcs.WCS(header)
scidata = hdulist[0].data[:,:] # in order: dec, ra
nh3data = scidata 
pixcoord = w.all_world2pix(worldcoord,1) # FITS standard uses 1
xx = pixcoord[:,0]
yy = pixcoord[:,1]
nh3xx = xx
nh3yy = yy
hdulist.close()

nh3efile = '/Users/shuokong/GoogleDrive/AncillaryData/GBT/OrionA_eVlsr_DR1_rebase3_flag.fits'
print nh3efile
hdulist = pyfits.open(nh3efile)
scidata = hdulist[0].data[:,:] # in order: dec, ra
enh3data = scidata 
hdulist.close()
print 'finish getting nh3 metadata'

singleGaussDict = {
                   '1':{'13CO':[8.95],'C18O':[8.62]},
                   '2':{'13CO':[6.20],'C18O':[6.20]},
                   '3':{'13CO':[10.05],'C18O':[10.16]},
                   '4':{'13CO':[7.19],'C18O':[7.19]},
                   '5':{'13CO':[11.15],'C18O':[11.04]},
                   '6':{'13CO':[8.51],'C18O':[8.51]},
                   '7':{'13CO':[10.16],'C18O':[10.16]},
                   '8':{'13CO':[7.08],'C18O':[6.75]},
                   '9':{'13CO':[10.93],'C18O':[11.04]},
                   '10':{'13CO':[9.06],'C18O':[9.06]},
                   '11':{'13CO':[9.50],'C18O':[9.50]},
                   '12':{'13CO':[9.28],'C18O':[9.39]},
                   '13':{'13CO':[9.83],'C18O':[9.72]},
                   '14':{'13CO':[10.71],'C18O':[8.62]},
                   '15':{'13CO':[10.16],'C18O':[10.27]},
                   '16':{'13CO':[9.39],'C18O':[9.61]},
                   '17':{'13CO':[9.39],'C18O':[9.39]},
                   '18':{'13CO':[9.50],'C18O':[9.28]},
                   '19':{'13CO':[11.04],'C18O':[11.37]},
                   '20':{'13CO':[9.83],'C18O':[9.94]},
                   '21':{'13CO':[11.04],'C18O':[11.26]},
                   '22':{'13CO':[10.82],'C18O':[11.15]},
                   '23':{'13CO':[10.05],'C18O':[11.15]},
                   '24':{'13CO':[8.84],'C18O':[6.97]},
                   '25':{'13CO':[8.],'C18O':[8.]},
                   '26':{'13CO':[8.95],'C18O':[8.95]},
                   '27':{'13CO':[9.94],'C18O':[9.94]},
                   '28':{'13CO':[8.07],'C18O':[8.62]},
                   '29':{'13CO':[7.96],'C18O':[7.85]},
                   '30':{'13CO':[10.38],'C18O':[10.60]},
                   '31':{'13CO':[8.40],'C18O':[8.62]},
                   '32':{'13CO':[10.27],'C18O':[10.16]},
                   '33':{'13CO':[11.37],'C18O':[11.26]},
                   '34':{'13CO':[11.15],'C18O':[11.04]},
                   '35':{'13CO':[10.49],'C18O':[10.38]},
                   '36':{'13CO':[11.59],'C18O':[12.14]},
                   '37':{'13CO':[6.64],'C18O':[6.42]},
                   '38':{'13CO':[8.29],'C18O':[8.07]},
                   '39':{'13CO':[10.82],'C18O':[10.93]},
                   '40':{'13CO':[11.48],'C18O':[11.37]},
                   '41':{'13CO':[7.96],'C18O':[8.18]},
                   '42':{'13CO':[10.93],'C18O':[11.04]},
                   '43':{'13CO':[8.07],'C18O':[7.96]},
                   '44':{'13CO':[10.93],'C18O':[11.04]},
                   '45':{'13CO':[10.49],'C18O':[10.38]},
                   '46':{'13CO':[9.83],'C18O':[9.61]},
                   '47':{'13CO':[11.15],'C18O':[11.15]},
                   '48':{'13CO':[7.96],'C18O':[7.96]},
                   '49':{'13CO':[10.71],'C18O':[10.38]},
                   '50':{'13CO':[11.15],'C18O':[11.26]},
                   '51':{'13CO':[8.62],'C18O':[8.51]},
                   '52':{'13CO':[9.17],'C18O':[8.84]},
                   '53':{'13CO':[6.75],'C18O':[6.75]},
                   '54':{'13CO':[10.27],'C18O':[10.27]},
                   '55':{'13CO':[10.27],'C18O':[10.27]},
                   '56':{'13CO':[10.38],'C18O':[10.60]},
                   '57':{'13CO':[11.59],'C18O':[11.59]},
                   '58':{'13CO':[10.82],'C18O':[10.82]},
                   '59':{'13CO':[7.63],'C18O':[7.74]},
                   '60':{'13CO':[9.39],'C18O':[9.17]},
                   '61':{'13CO':[6.97],'C18O':[6.97]},
                   '62':{'13CO':[8.],'C18O':[8.]},
                   '63':{'13CO':[8.62],'C18O':[8.51]},
                   '64':{'13CO':[8.],'C18O':[8.]},
                   '65':{'13CO':[8.73],'C18O':[8.51]},
                   '66':{'13CO':[7.30],'C18O':[7.19]},
                   '67':{'13CO':[6.64],'C18O':[6.53]},
                   '68':{'13CO':[11.04],'C18O':[10.93]},
                   '69':{'13CO':[11.26],'C18O':[11.04]},
                   '70':{'13CO':[8.40],'C18O':[7.63]},
                   '71':{'13CO':[10.38],'C18O':[10.60]},
                   '72':{'13CO':[10.16],'C18O':[11.15]},
                   '73':{'13CO':[8.18],'C18O':[8.07]},
                   '74':{'13CO':[8.62],'C18O':[8.40]},
                   '75':{'13CO':[8.18],'C18O':[8.51]},
                   '76':{'13CO':[9.39],'C18O':[9.61]},
                   '77':{'13CO':[11.15],'C18O':[11.04]},
                   '78':{'13CO':[8.],'C18O':[8.]},
                   '79':{'13CO':[6.42],'C18O':[6.20]},
                   '80':{'13CO':[7.08],'C18O':[6.53]},
                   '81':{'13CO':[6.75],'C18O':[6.86]},
                   '82':{'13CO':[11.48],'C18O':[11.48]},
                   '83':{'13CO':[10.93],'C18O':[10.93]},
                   '84':{'13CO':[10.49],'C18O':[10.49]},
                   '85':{'13CO':[9.72],'C18O':[9.28]},
                   '86':{'13CO':[7.74],'C18O':[11.48]},
                   '87':{'13CO':[8.62],'C18O':[8.40]},
                   '88':{'13CO':[11.70],'C18O':[11.81]},
                   '89':{'13CO':[8.],'C18O':[8.]},
                   '90':{'13CO':[10.38],'C18O':[8.95]},
                   '91':{'13CO':[8.51],'C18O':[8.62]},
                   '92':{'13CO':[10.27],'C18O':[9.72]},
                   '93':{'13CO':[8.29],'C18O':[7.96]},
                   '94':{'13CO':[9.17],'C18O':[8.95]},
                   '95':{'13CO':[10.93],'C18O':[11.15]},
                   '96':{'13CO':[5.98],'C18O':[5.98]},
                   '97':{'13CO':[8.51],'C18O':[8.51]},
                   '98':{'13CO':[9.83],'C18O':[9.83]},
                   '99':{'13CO':[8.62],'C18O':[8.18]},
                   '100':{'13CO':[10.60],'C18O':[10.60]},
                   '101':{'13CO':[11.26],'C18O':[11.48]},
                   '102':{'13CO':[8.],'C18O':[8.]},
                   '103':{'13CO':[8.07],'C18O':[8.18]},
                   '104':{'13CO':[9.83],'C18O':[9.17]},
                   '105':{'13CO':[11.48],'C18O':[11.59]},
                   '106':{'13CO':[11.59],'C18O':[11.70]},
                   '107':{'13CO':[7.74],'C18O':[7.74]},
                   '108':{'13CO':[10.60],'C18O':[10.60]},
                   '109':{'13CO':[11.26],'C18O':[11.26]},
                   '110':{'13CO':[11.26],'C18O':[11.15]},
                   '111':{'13CO':[11.26],'C18O':[0.59]},
                   '112':{'13CO':[6.53],'C18O':[6.86]},
                   '113':{'13CO':[8.],'C18O':[8.]},
                   '114':{'13CO':[8.84],'C18O':[8.51]},
                   '115':{'13CO':[6.97],'C18O':[6.86]},
                   '116':{'13CO':[11.04],'C18O':[10.93]},
                   '117':{'13CO':[10.49],'C18O':[10.49]},
                   '118':{'13CO':[8.84],'C18O':[8.84]},
                   '119':{'13CO':[6.20],'C18O':[6.42]},
                   '120':{'13CO':[11.26],'C18O':[11.48]},
                   '121':{'13CO':[8.29],'C18O':[8.07]},
                   '122':{'13CO':[7.19],'C18O':[7.19]},
                   '123':{'13CO':[10.71],'C18O':[10.49]},
                   '124':{'13CO':[8.29],'C18O':[8.18]},
                   '125':{'13CO':[11.48],'C18O':[11.59]},
                   '126':{'13CO':[10.38],'C18O':[9.28]},
                   '127':{'13CO':[8.84],'C18O':[8.95]},
                   '128':{'13CO':[9.61],'C18O':[9.50]},
                   '129':{'13CO':[12.03],'C18O':[12.25]},
                   '130':{'13CO':[11.70],'C18O':[11.70]},
                   '131':{'13CO':[7.30],'C18O':[8.40]},
                   '132':{'13CO':[8.],'C18O':[8.]},
                   '133':{'13CO':[7.74],'C18O':[7.63]},
                   '134':{'13CO':[7.96],'C18O':[8.07]},
                   '135':{'13CO':[9.06],'C18O':[9.06]},
                   '136':{'13CO':[9.06],'C18O':[8.62]},
                   '137':{'13CO':[10.93],'C18O':[11.04]},
                   '138':{'13CO':[10.60],'C18O':[11.04]},
                   '139':{'13CO':[10.93],'C18O':[10.82]},
                   '140':{'13CO':[8.62],'C18O':[8.84]},
                   '141':{'13CO':[11.04],'C18O':[11.15]},
                   '142':{'13CO':[11.59],'C18O':[11.48]},
                   '143':{'13CO':[8.],'C18O':[8.]},
                   '144':{'13CO':[10.93],'C18O':[11.15]},
                   '145':{'13CO':[10.93],'C18O':[11.48]},
                   '146':{'13CO':[7.85],'C18O':[7.85]},
                   '147':{'13CO':[10.71],'C18O':[10.71]},
                   '148':{'13CO':[9.17],'C18O':[8.40]},
                   '149':{'13CO':[8.],'C18O':[8.]},
                   '150':{'13CO':[6.64],'C18O':[6.53]},
                   '151':{'13CO':[8.51],'C18O':[8.51]},
                   '152':{'13CO':[6.97],'C18O':[7.30]},
                   '153':{'13CO':[6.97],'C18O':[7.08]},
                   '154':{'13CO':[8.51],'C18O':[8.51]},
                   '155':{'13CO':[9.06],'C18O':[8.95]},
                   '156':{'13CO':[10.38],'C18O':[10.38]},
                   '157':{'13CO':[10.38],'C18O':[7.96]},
                   '158':{'13CO':[5.87],'C18O':[6.97]},
                   '159':{'13CO':[8.62],'C18O':[8.51]},
                   '160':{'13CO':[8.18],'C18O':[8.18]},
                   '161':{'13CO':[11.70],'C18O':[11.81]},
                   '162':{'13CO':[9.50],'C18O':[9.39]},
                   '163':{'13CO':[7.30],'C18O':[7.85]},
                   '164':{'13CO':[9.17],'C18O':[9.06]},
                   '165':{'13CO':[7.63],'C18O':[7.63]},
                   '166':{'13CO':[10.93],'C18O':[10.82]},
                   '167':{'13CO':[10.93],'C18O':[10.93]},
                   '168':{'13CO':[6.97],'C18O':[6.86]},
                   '169':{'13CO':[8.95],'C18O':[8.18]},
                   '170':{'13CO':[10.71],'C18O':[10.60]},
                   '171':{'13CO':[8.],'C18O':[8.]},
                   '172':{'13CO':[6.86],'C18O':[6.75]},
                   '173':{'13CO':[6.42],'C18O':[6.20]},
                   '174':{'13CO':[7.30],'C18O':[7.08]},
                   '175':{'13CO':[8.07],'C18O':[7.85]},
                   '176':{'13CO':[10.38],'C18O':[10.93]},
                   '177':{'13CO':[11.26],'C18O':[11.26]},
                   '178':{'13CO':[9.72],'C18O':[9.61]},
                   '179':{'13CO':[10.38],'C18O':[10.82]},
                   '180':{'13CO':[10.27],'C18O':[9.61]},
                   '181':{'13CO':[11.59],'C18O':[11.70]},
                   '182':{'13CO':[11.15],'C18O':[11.26]},
                   '183':{'13CO':[11.04],'C18O':[10.93]},
                   '184':{'13CO':[8.84],'C18O':[8.84]},
                   '185':{'13CO':[9.94],'C18O':[10.38]},
                   '186':{'13CO':[9.06],'C18O':[8.95]},
                   '187':{'13CO':[6.64],'C18O':[6.42]},
                   '188':{'13CO':[6.86],'C18O':[7.08]},
                   '189':{'13CO':[8.29],'C18O':[8.29]},
                   '190':{'13CO':[8.],'C18O':[8.]},
                   '191':{'13CO':[8.84],'C18O':[8.73]},
                   '192':{'13CO':[11.26],'C18O':[11.48]},
                   '193':{'13CO':[10.71],'C18O':[10.71]},
                   '194':{'13CO':[7.85],'C18O':[7.85]},
                   '195':{'13CO':[7.63],'C18O':[7.63]},
                   '196':{'13CO':[7.96],'C18O':[8.07]},
                   '197':{'13CO':[10.38],'C18O':[10.49]},
                   '198':{'13CO':[11.37],'C18O':[11.37]},
                   '199':{'13CO':[7.96],'C18O':[7.96]},
                   '200':{'13CO':[8.07],'C18O':[8.18]},
                   '201':{'13CO':[9.72],'C18O':[9.72]},
                   '202':{'13CO':[9.06],'C18O':[9.17]},
                   '203':{'13CO':[10.93],'C18O':[11.04]},
                   '204':{'13CO':[8.40],'C18O':[8.40]},
                   '205':{'13CO':[8.18],'C18O':[8.07]},
                   '206':{'13CO':[11.04],'C18O':[10.93]},
                   '207':{'13CO':[11.15],'C18O':[11.26]},
                   '208':{'13CO':[11.04],'C18O':[11.15]},
                   '209':{'13CO':[8.51],'C18O':[8.51]},
                   '210':{'13CO':[8.62],'C18O':[8.62]},
                   '211':{'13CO':[10.82],'C18O':[10.71]},
                   '212':{'13CO':[10.82],'C18O':[10.82]},
                   '213':{'13CO':[11.70],'C18O':[11.92]},
                   '214':{'13CO':[8.],'C18O':[8.]},
                   '215':{'13CO':[9.72],'C18O':[10.93]},
                   '216':{'13CO':[8.],'C18O':[8.]},
                   '217':{'13CO':[7.52],'C18O':[7.63]},
                   '218':{'13CO':[8.73],'C18O':[8.73]},
                   '219':{'13CO':[7.41],'C18O':[7.74]},
                   '220':{'13CO':[7.08],'C18O':[8.18]},
                   '221':{'13CO':[8.40],'C18O':[8.51]},
                   '222':{'13CO':[10.71],'C18O':[10.38]},
                   '223':{'13CO':[10.71],'C18O':[10.82]},
                   '224':{'13CO':[10.82],'C18O':[9.17]},
                   '225':{'13CO':[8.51],'C18O':[8.18]},
                   '226':{'13CO':[8.73],'C18O':[8.73]},
                   '227':{'13CO':[7.41],'C18O':[7.19]},
                   '228':{'13CO':[9.17],'C18O':[8.29]},
                   '229':{'13CO':[9.28],'C18O':[9.28]},
                   '230':{'13CO':[10.93],'C18O':[11.04]},
                   '231':{'13CO':[11.48],'C18O':[11.26]},
                   '232':{'13CO':[12.58],'C18O':[12.69]},
                   '233':{'13CO':[10.93],'C18O':[4.11]},
                   '234':{'13CO':[7.96],'C18O':[7.74]},
                   '235':{'13CO':[7.30],'C18O':[7.30]},
                   '236':{'13CO':[8.],'C18O':[8.]},
                   '237':{'13CO':[4.11],'C18O':[10.05]},
                   '238':{'13CO':[8.29],'C18O':[8.29]},
                   '239':{'13CO':[8.62],'C18O':[8.51]},
                   '240':{'13CO':[10.93],'C18O':[10.71]},
                   '241':{'13CO':[10.93],'C18O':[11.04]},
                   '242':{'13CO':[10.71],'C18O':[10.71]},
                   '243':{'13CO':[11.48],'C18O':[11.48]},
                   '244':{'13CO':[7.08],'C18O':[7.08]},
                   '245':{'13CO':[10.49],'C18O':[9.72]},
                   '246':{'13CO':[7.63],'C18O':[7.85]},
                   '247':{'13CO':[10.38],'C18O':[10.49]},
                   '248':{'13CO':[11.15],'C18O':[2.13]},
                   '249':{'13CO':[10.60],'C18O':[10.71]},
                   '250':{'13CO':[11.70],'C18O':[11.81]},
                   '251':{'13CO':[7.08],'C18O':[14.45]},
                   '252':{'13CO':[6.86],'C18O':[6.42]},
                   '253':{'13CO':[7.19],'C18O':[7.30]},
                   '254':{'13CO':[9.28],'C18O':[9.39]},
                   '255':{'13CO':[8.07],'C18O':[8.07]},
                   '256':{'13CO':[9.28],'C18O':[9.39]},
                   '257':{'13CO':[9.94],'C18O':[9.61]},
                   '258':{'13CO':[6.64],'C18O':[6.64]},
                   '259':{'13CO':[7.74],'C18O':[7.74]},
                   '260':{'13CO':[10.38],'C18O':[10.27]},
                   '261':{'13CO':[8.],'C18O':[8.]},
                   '262':{'13CO':[8.73],'C18O':[13.35]},
                   '263':{'13CO':[8.],'C18O':[8.]},
                   '264':{'13CO':[8.29],'C18O':[8.18]},
                   '265':{'13CO':[8.29],'C18O':[8.29]},
                   '266':{'13CO':[12.58],'C18O':[12.47]},
                   '267':{'13CO':[8.],'C18O':[8.]},
                   '268':{'13CO':[9.50],'C18O':[7.19]},
                   '269':{'13CO':[11.37],'C18O':[11.26]},
                   '270':{'13CO':[8.],'C18O':[8.]},
                   '271':{'13CO':[8.],'C18O':[8.]},
                   '272':{'13CO':[7.96],'C18O':[7.85]},
                   '273':{'13CO':[6.53],'C18O':[6.53]},
                   '274':{'13CO':[8.07],'C18O':[8.84]},
                   '275':{'13CO':[6.53],'C18O':[6.42]},
                   '276':{'13CO':[9.61],'C18O':[7.74]},
                   '277':{'13CO':[9.06],'C18O':[6.31]},
                   '278':{'13CO':[8.07],'C18O':[8.18]},
                   '279':{'13CO':[8.95],'C18O':[8.95]},
                   '280':{'13CO':[9.17],'C18O':[9.17]},
                   '281':{'13CO':[8.],'C18O':[8.]},
                   '282':{'13CO':[8.73],'C18O':[8.95]},
                   '283':{'13CO':[7.41],'C18O':[7.85]},
                   '284':{'13CO':[7.96],'C18O':[7.96]},
                   '285':{'13CO':[7.19],'C18O':[7.08]},
                   '286':{'13CO':[7.41],'C18O':[7.63]},
                   '287':{'13CO':[7.08],'C18O':[6.75]},
                   '288':{'13CO':[9.50],'C18O':[9.50]},
                   '289':{'13CO':[5.98],'C18O':[5.98]},
                   '290':{'13CO':[9.72],'C18O':[9.72]},
                   '291':{'13CO':[9.83],'C18O':[9.61]},
                   '292':{'13CO':[11.04],'C18O':[11.04]},
                   '293':{'13CO':[11.59],'C18O':[11.59]},
                   '294':{'13CO':[8.51],'C18O':[8.29]},
                   '295':{'13CO':[8.07],'C18O':[7.96]},
                   '296':{'13CO':[9.72],'C18O':[9.39]},
                   '297':{'13CO':[7.52],'C18O':[7.30]},
                   '298':{'13CO':[9.72],'C18O':[8.51]},
                   '299':{'13CO':[9.39],'C18O':[9.50]},
                   '300':{'13CO':[11.04],'C18O':[11.04]},
                   '301':{'13CO':[11.04],'C18O':[11.15]},
                   '302':{'13CO':[10.93],'C18O':[10.71]},
                   '303':{'13CO':[11.26],'C18O':[11.70]},
                   '304':{'13CO':[10.82],'C18O':[8.73]},
                   '305':{'13CO':[7.30],'C18O':[10.49]},
                   '306':{'13CO':[9.28],'C18O':[9.28]},
                   '307':{'13CO':[10.60],'C18O':[10.49]},
                   '308':{'13CO':[8.],'C18O':[8.]},
                   '309':{'13CO':[8.18],'C18O':[8.29]},
                   '310':{'13CO':[10.49],'C18O':[12.25]},
                   '311':{'13CO':[8.51],'C18O':[8.40]},
                   '312':{'13CO':[7.96],'C18O':[7.63]},
                   '313':{'13CO':[8.62],'C18O':[15.22]},
                   '314':{'13CO':[8.],'C18O':[8.]},
                   '315':{'13CO':[7.08],'C18O':[7.08]},
                   '316':{'13CO':[8.29],'C18O':[8.29]},
                   '317':{'13CO':[7.96],'C18O':[8.07]},
                   '318':{'13CO':[11.04],'C18O':[0]},
                   '319':{'13CO':[10.82],'C18O':[10.71]},
                   '320':{'13CO':[8.73],'C18O':[8.95]},
                   '321':{'13CO':[10.71],'C18O':[10.49]},
                   '322':{'13CO':[0],'C18O':[0]},
                   '323':{'13CO':[10.16],'C18O':[9.28]},
                   '324':{'13CO':[8.29],'C18O':[8.29]},
                   '325':{'13CO':[8.],'C18O':[8.]},
                   '326':{'13CO':[6.09],'C18O':[6.09]},
                   '327':{'13CO':[11.26],'C18O':[11.26]},
                   '328':{'13CO':[8.],'C18O':[8.]},
                   '329':{'13CO':[8.95],'C18O':[8.95]},
                   '330':{'13CO':[10.27],'C18O':[10.38]},
                   '331':{'13CO':[10.16],'C18O':[10.16]},
                   '332':{'13CO':[8.62],'C18O':[8.07]},
                   '333':{'13CO':[10.16],'C18O':[13.46]},
                   '334':{'13CO':[10.60],'C18O':[10.38]},
                   '335':{'13CO':[8.95],'C18O':[0]},
                   '336':{'13CO':[6.53],'C18O':[7.52]},
                   '337':{'13CO':[6.64],'C18O':[5.32]},
                   '338':{'13CO':[6.75],'C18O':[6.64]},
                   '339':{'13CO':[6.97],'C18O':[7.08]},
                   '340':{'13CO':[11.15],'C18O':[9.94]},
                   '341':{'13CO':[8.],'C18O':[8.]},
                   '342':{'13CO':[8.18],'C18O':[7.41]},
                   '343':{'13CO':[11.48],'C18O':[11.81]},
                   '344':{'13CO':[9.72],'C18O':[9.83]},
                   '345':{'13CO':[10.38],'C18O':[11.26]},
                   '346':{'13CO':[9.39],'C18O':[9.17]},
                   '347':{'13CO':[8.],'C18O':[8.]},
                   '348':{'13CO':[6.09],'C18O':[5.98]},
                   '349':{'13CO':[11.37],'C18O':[11.59]},
                   '350':{'13CO':[8.],'C18O':[8.]},
                   '351':{'13CO':[8.],'C18O':[8.]},
                   '352':{'13CO':[5.87],'C18O':[6.86]},
                   '353':{'13CO':[9.28],'C18O':[9.28]},
                   '354':{'13CO':[10.93],'C18O':[11.04]},
                   '355':{'13CO':[11.26],'C18O':[11.59]},
                   '356':{'13CO':[10.71],'C18O':[10.82]},
                   '357':{'13CO':[8.62],'C18O':[8.51]},
                   '358':{'13CO':[7.85],'C18O':[7.96]},
                   '359':{'13CO':[9.06],'C18O':[4.77]},
                   '360':{'13CO':[8.],'C18O':[8.]},
                   '361':{'13CO':[9.17],'C18O':[8.95]},
                   '362':{'13CO':[9.06],'C18O':[8.95]},
                   '363':{'13CO':[6.42],'C18O':[6.20]},
                   '364':{'13CO':[8.73],'C18O':[9.06]},
                   '365':{'13CO':[9.39],'C18O':[9.39]},
                   '366':{'13CO':[10.16],'C18O':[10.38]},
                   '367':{'13CO':[11.15],'C18O':[11.15]},
                   '368':{'13CO':[11.81],'C18O':[11.92]},
                   '369':{'13CO':[9.17],'C18O':[8.84]},
                   '370':{'13CO':[5.54],'C18O':[5.54]},
                   '371':{'13CO':[7.41],'C18O':[8.84]},
                   '372':{'13CO':[8.51],'C18O':[8.40]},
                   '373':{'13CO':[9.17],'C18O':[9.28]},
                   '374':{'13CO':[11.26],'C18O':[10.82]},
                   '375':{'13CO':[10.93],'C18O':[8.40]},
                   '376':{'13CO':[6.20],'C18O':[7.41]},
                   '377':{'13CO':[7.19],'C18O':[6.97]},
                   '378':{'13CO':[8.07],'C18O':[7.74]},
                   '379':{'13CO':[7.96],'C18O':[7.85]},
                   '380':{'13CO':[10.05],'C18O':[3.01]},
                   '381':{'13CO':[10.82],'C18O':[8.18]},
                   '382':{'13CO':[11.15],'C18O':[9.61]},
                   '383':{'13CO':[8.],'C18O':[8.]},
                   '384':{'13CO':[6.86],'C18O':[9.28]},
                   '385':{'13CO':[8.95],'C18O':[6.97]},
                   '386':{'13CO':[7.30],'C18O':[7.41]},
                   '387':{'13CO':[8.84],'C18O':[7.19]},
                   '388':{'13CO':[8.73],'C18O':[9.72]},
                   '389':{'13CO':[9.06],'C18O':[10.49]},
                   '390':{'13CO':[11.48],'C18O':[11.59]},
                   '391':{'13CO':[11.26],'C18O':[10.82]},
                   '392':{'13CO':[10.93],'C18O':[8.51]},
                   '393':{'13CO':[8.],'C18O':[8.]},
                   '394':{'13CO':[5.32],'C18O':[1.69]},
                   '395':{'13CO':[7.52],'C18O':[7.52]},
                   '396':{'13CO':[7.96],'C18O':[7.74]},
                   '397':{'13CO':[10.05],'C18O':[11.48]},
                   '398':{'13CO':[11.26],'C18O':[2.13]},
                   '399':{'13CO':[11.04],'C18O':[10.93]},
                   '400':{'13CO':[11.04],'C18O':[11.04]},
                   '401':{'13CO':[10.38],'C18O':[10.27]},
                   '402':{'13CO':[10.93],'C18O':[10.93]},
                   '403':{'13CO':[10.93],'C18O':[11.15]},
                   '404':{'13CO':[8.],'C18O':[8.]},
                   '405':{'13CO':[7.19],'C18O':[8.84]},
                   '406':{'13CO':[8.51],'C18O':[8.40]},
                   '407':{'13CO':[9.39],'C18O':[9.50]},
                   '408':{'13CO':[10.49],'C18O':[0]},
                   '409':{'13CO':[11.15],'C18O':[10.93]},
                   '410':{'13CO':[6.42],'C18O':[6.53]},
                   '411':{'13CO':[6.86],'C18O':[6.64]},
                   '412':{'13CO':[7.19],'C18O':[7.08]},
                   '413':{'13CO':[6.53],'C18O':[6.53]},
                   '414':{'13CO':[6.75],'C18O':[6.53]},
                   '415':{'13CO':[11.59],'C18O':[11.48]},
                   '416':{'13CO':[10.71],'C18O':[11.04]},
                   '417':{'13CO':[9.17],'C18O':[1.69]},
                   '418':{'13CO':[10.38],'C18O':[8.95]},
                   '419':{'13CO':[5.32],'C18O':[10.16]},
                   '420':{'13CO':[8.07],'C18O':[7.19]},
                   '421':{'13CO':[7.08],'C18O':[6.97]},
                   '422':{'13CO':[10.82],'C18O':[10.71]},
                   '423':{'13CO':[11.70],'C18O':[11.70]},
                   '424':{'13CO':[12.58],'C18O':[12.47]},
                   '425':{'13CO':[11.15],'C18O':[7.30]},
                   '426':{'13CO':[10.71],'C18O':[1.14]},
                   '427':{'13CO':[8.],'C18O':[8.]},
                   '428':{'13CO':[8.18],'C18O':[8.18]},
                   '429':{'13CO':[7.41],'C18O':[7.52]},
                   '430':{'13CO':[10.93],'C18O':[11.15]},
                   '431':{'13CO':[6.97],'C18O':[8.73]},
                   '432':{'13CO':[8.18],'C18O':[7.41]},
                   '433':{'13CO':[8.18],'C18O':[7.63]},
                   '434':{'13CO':[11.26],'C18O':[10.93]},
                   '435':{'13CO':[10.38],'C18O':[10.60]},
                   '436':{'13CO':[9.17],'C18O':[0]},
                   '437':{'13CO':[8.18],'C18O':[8.07]},
                   '438':{'13CO':[7.08],'C18O':[7.08]},
                   '439':{'13CO':[7.19],'C18O':[6.09]},
                   '440':{'13CO':[8.40],'C18O':[8.07]},
                   '441':{'13CO':[7.85],'C18O':[9.06]},
                   '442':{'13CO':[8.],'C18O':[8.]},
                   '443':{'13CO':[6.20],'C18O':[7.30]},
                   '444':{'13CO':[8.29],'C18O':[7.96]},
                   '445':{'13CO':[7.08],'C18O':[6.75]},
                   '446':{'13CO':[8.],'C18O':[8.]},
                   '447':{'13CO':[11.15],'C18O':[11.37]},
                   '448':{'13CO':[8.40],'C18O':[8.40]},
                   '449':{'13CO':[9.39],'C18O':[0]},
                   '450':{'13CO':[10.38],'C18O':[10.60]},
                   '451':{'13CO':[8.],'C18O':[8.]},
                   '452':{'13CO':[8.],'C18O':[8.]},
                   '453':{'13CO':[8.],'C18O':[8.]},
                   '454':{'13CO':[8.07],'C18O':[9.72]},
                   '455':{'13CO':[6.09],'C18O':[6.97]},
                   '456':{'13CO':[8.29],'C18O':[6.86]},
                   '457':{'13CO':[6.31],'C18O':[6.20]},
                   '458':{'13CO':[9.61],'C18O':[9.61]},
                   '459':{'13CO':[8.95],'C18O':[8.40]},
                   '460':{'13CO':[10.38],'C18O':[10.05]},
                   '461':{'13CO':[10.60],'C18O':[10.71]},
                   '462':{'13CO':[11.70],'C18O':[11.70]},
                   '463':{'13CO':[10.71],'C18O':[10.49]},
                   '464':{'13CO':[10.93],'C18O':[10.82]},
                   '465':{'13CO':[8.],'C18O':[8.]},
                   '466':{'13CO':[8.],'C18O':[0]},
                   '467':{'13CO':[6.97],'C18O':[7.08]},
                   '468':{'13CO':[9.28],'C18O':[9.06]},
                   '469':{'13CO':[7.52],'C18O':[7.41]},
                   '470':{'13CO':[8.40],'C18O':[8.62]},
                   '471':{'13CO':[7.08],'C18O':[7.19]},
                   '472':{'13CO':[9.50],'C18O':[9.61]},
                   '473':{'13CO':[11.92],'C18O':[12.36]},
                   '474':{'13CO':[8.],'C18O':[8.]},
                   '475':{'13CO':[8.],'C18O':[8.]},
                   '476':{'13CO':[10.49],'C18O':[8.29]},
                   '477':{'13CO':[8.07],'C18O':[8.40]},
                   '478':{'13CO':[6.75],'C18O':[8.07]},
                   '479':{'13CO':[6.75],'C18O':[7.63]},
                   '480':{'13CO':[7.85],'C18O':[7.63]},
                   '481':{'13CO':[8.73],'C18O':[8.29]},
                   '482':{'13CO':[8.18],'C18O':[7.96]},
                   '483':{'13CO':[9.39],'C18O':[9.28]},
                   '484':{'13CO':[10.38],'C18O':[0]},
                   '485':{'13CO':[11.81],'C18O':[11.70]},
                   '486':{'13CO':[11.04],'C18O':[11.04]},
                   '487':{'13CO':[10.93],'C18O':[7.96]},
                   '488':{'13CO':[8.],'C18O':[8.]},
                   '489':{'13CO':[8.],'C18O':[8.]},
                   '490':{'13CO':[11.37],'C18O':[14.67]},
                   '491':{'13CO':[8.],'C18O':[8.]},
                   '492':{'13CO':[9.28],'C18O':[9.17]},
                   '493':{'13CO':[8.51],'C18O':[8.40]},
                   '494':{'13CO':[9.06],'C18O':[9.06]},
                   '495':{'13CO':[8.18],'C18O':[8.18]},
                   '496':{'13CO':[9.72],'C18O':[9.83]},
                   '497':{'13CO':[10.05],'C18O':[8.73]},
                   '498':{'13CO':[9.72],'C18O':[9.72]},
                   '499':{'13CO':[10.49],'C18O':[10.60]},
                   '500':{'13CO':[11.37],'C18O':[11.26]},
                   '501':{'13CO':[8.],'C18O':[8.]},
                   '502':{'13CO':[8.],'C18O':[8.]},
                   '503':{'13CO':[8.62],'C18O':[8.29]},
                   '504':{'13CO':[11.37],'C18O':[11.15]},
                   '505':{'13CO':[8.],'C18O':[8.]},
                   '506':{'13CO':[7.74],'C18O':[6.20]},
                   '507':{'13CO':[10.27],'C18O':[10.38]},
                   '508':{'13CO':[9.06],'C18O':[8.84]},
                   '509':{'13CO':[6.20],'C18O':[5.87]},
                   '510':{'13CO':[10.93],'C18O':[11.15]},
                   '511':{'13CO':[7.41],'C18O':[7.63]},
                   '512':{'13CO':[6.42],'C18O':[6.31]},
                   '513':{'13CO':[6.20],'C18O':[5.98]},
                   '514':{'13CO':[7.96],'C18O':[7.85]},
                   '515':{'13CO':[11.26],'C18O':[5.87]},
                   '516':{'13CO':[8.18],'C18O':[8.07]},
                   '517':{'13CO':[10.60],'C18O':[10.49]},
                   '518':{'13CO':[10.38],'C18O':[10.27]},
                   '519':{'13CO':[9.17],'C18O':[8.51]},
                   '520':{'13CO':[10.49],'C18O':[8.18]},
                   '521':{'13CO':[8.],'C18O':[8.]},
                   '522':{'13CO':[8.],'C18O':[8.]},
                   '523':{'13CO':[7.19],'C18O':[7.08]},
                   '524':{'13CO':[7.30],'C18O':[7.41]},
                   '525':{'13CO':[7.96],'C18O':[8.51]},
                   '526':{'13CO':[11.59],'C18O':[11.26]},
                   '527':{'13CO':[10.60],'C18O':[8.40]},
                   '528':{'13CO':[8.],'C18O':[8.]},
                   '529':{'13CO':[8.],'C18O':[8.]},
                   '530':{'13CO':[10.49],'C18O':[7.41]},
                   '531':{'13CO':[8.],'C18O':[8.]},
                   '532':{'13CO':[9.72],'C18O':[9.17]},
                   '533':{'13CO':[8.],'C18O':[8.]},
                   '534':{'13CO':[6.20],'C18O':[6.31]},
                   '535':{'13CO':[9.28],'C18O':[7.52]},
                   '536':{'13CO':[8.51],'C18O':[8.40]},
                   '537':{'13CO':[7.96],'C18O':[7.96]},
                   '538':{'13CO':[9.06],'C18O':[7.85]},
                   '539':{'13CO':[7.30],'C18O':[7.30]},
                   '540':{'13CO':[11.70],'C18O':[11.70]},
                   '541':{'13CO':[8.84],'C18O':[8.84]},
                   '542':{'13CO':[11.26],'C18O':[11.26]},
                   '543':{'13CO':[11.48],'C18O':[11.37]},
                   '544':{'13CO':[11.15],'C18O':[11.04]},
                   '545':{'13CO':[11.04],'C18O':[11.04]},
                   '546':{'13CO':[11.15],'C18O':[11.15]},
                   '547':{'13CO':[7.96],'C18O':[7.74]},
                   '548':{'13CO':[9.06],'C18O':[8.84]},
                   '549':{'13CO':[8.07],'C18O':[8.07]},
                   '550':{'13CO':[10.38],'C18O':[10.27]},
                   '551':{'13CO':[7.74],'C18O':[7.30]},
                   '552':{'13CO':[7.30],'C18O':[7.19]},
                   '553':{'13CO':[8.84],'C18O':[4.00]},
                   '554':{'13CO':[8.62],'C18O':[8.62]},
                   '555':{'13CO':[11.48],'C18O':[12.03]},
                   '556':{'13CO':[8.62],'C18O':[6.42]},
                   '557':{'13CO':[8.07],'C18O':[6.86]},
                   '558':{'13CO':[10.93],'C18O':[10.82]},
                   '559':{'13CO':[8.],'C18O':[8.]},
                   '560':{'13CO':[8.18],'C18O':[8.18]},
                   '561':{'13CO':[7.08],'C18O':[9.83]},
                   '562':{'13CO':[0],'C18O':[0]},
                   '563':{'13CO':[6.42],'C18O':[6.97]},
                   '564':{'13CO':[8.18],'C18O':[0]},
                   '565':{'13CO':[7.30],'C18O':[7.30]},
                   '566':{'13CO':[11.26],'C18O':[11.26]},
                   '567':{'13CO':[8.],'C18O':[8.]},
                   '568':{'13CO':[11.37],'C18O':[7.96]},
                   '569':{'13CO':[8.62],'C18O':[8.73]},
                   '570':{'13CO':[8.07],'C18O':[8.18]},
                   '571':{'13CO':[8.62],'C18O':[8.40]},
                   '572':{'13CO':[7.85],'C18O':[7.85]},
                   '573':{'13CO':[0],'C18O':[0]},
                   '574':{'13CO':[5.98],'C18O':[5.76]},
                   '575':{'13CO':[8.73],'C18O':[8.18]},
                   '576':{'13CO':[7.85],'C18O':[14.23]},
                   '577':{'13CO':[0],'C18O':[0]},
                   '578':{'13CO':[10.93],'C18O':[10.82]},
                   '579':{'13CO':[8.],'C18O':[8.]},
                   '580':{'13CO':[8.51],'C18O':[1.25]},
                   '581':{'13CO':[8.],'C18O':[8.]},
                   '582':{'13CO':[9.28],'C18O':[7.63]},
                   '583':{'13CO':[8.07],'C18O':[7.96]},
                   '584':{'13CO':[7.85],'C18O':[7.19]},
                   '585':{'13CO':[7.30],'C18O':[6.97]},
                   '586':{'13CO':[7.96],'C18O':[7.96]},
                   '587':{'13CO':[9.50],'C18O':[9.28]},
                   '588':{'13CO':[11.04],'C18O':[10.93]},
                   '589':{'13CO':[5.98],'C18O':[1.03]},
                   '590':{'13CO':[10.49],'C18O':[14.01]},
                   '591':{'13CO':[7.85],'C18O':[8.07]},
                   '592':{'13CO':[7.08],'C18O':[6.42]},
                   '593':{'13CO':[8.07],'C18O':[7.85]},
                   '594':{'13CO':[9.17],'C18O':[9.17]},
                   '595':{'13CO':[7.74],'C18O':[7.74]},
                   '596':{'13CO':[10.60],'C18O':[]},
                   '597':{'13CO':[9.28],'C18O':[9.39]},
                   '598':{'13CO':[10.60],'C18O':[7.30]},
                   '599':{'13CO':[3.67],'C18O':[9.94]},
                   '600':{'13CO':[9.39],'C18O':[0]},
                   '601':{'13CO':[9.39],'C18O':[7.85]},
                   '602':{'13CO':[9.28],'C18O':[9.28]},
                   '603':{'13CO':[10.93],'C18O':[10.82]},
                   '604':{'13CO':[8.],'C18O':[8.]},
                   '605':{'13CO':[8.],'C18O':[8.]},
                   '606':{'13CO':[8.40],'C18O':[9.06]},
                   '607':{'13CO':[8.],'C18O':[8.]},
                   '608':{'13CO':[8.95],'C18O':[6.86]},
                   '609':{'13CO':[11.04],'C18O':[4.33]},
                   '610':{'13CO':[8.18],'C18O':[7.96]},
                   '611':{'13CO':[8.40],'C18O':[7.96]},
                   '612':{'13CO':[9.06],'C18O':[8.95]},
                   '613':{'13CO':[8.18],'C18O':[7.85]},
                   '614':{'13CO':[5.32],'C18O':[5.32]},
                   '615':{'13CO':[6.42],'C18O':[6.42]},
                   '616':{'13CO':[10.38],'C18O':[10.38]},
                   '617':{'13CO':[10.38],'C18O':[7.96]},
                   '618':{'13CO':[8.],'C18O':[8.]},
                   '619':{'13CO':[8.],'C18O':[8.]},
                   '620':{'13CO':[6.64],'C18O':[6.53]},
                   '621':{'13CO':[7.41],'C18O':[7.30]},
                   '622':{'13CO':[8.73],'C18O':[8.29]},
                   '623':{'13CO':[8.95],'C18O':[8.73]},
                   '624':{'13CO':[8.07],'C18O':[8.07]},
                   '625':{'13CO':[11.26],'C18O':[4.77]},
                   '626':{'13CO':[8.62],'C18O':[12.03]},
                   '627':{'13CO':[7.19],'C18O':[11.70]},
                   '628':{'13CO':[7.08],'C18O':[7.30]},
                   '629':{'13CO':[10.49],'C18O':[10.60]},
                   '630':{'13CO':[10.27],'C18O':[10.27]},
                   '631':{'13CO':[8.40],'C18O':[6.20]},
                   '632':{'13CO':[9.28],'C18O':[7.85]},
                   '633':{'13CO':[7.85],'C18O':[7.74]},
                   '634':{'13CO':[6.31],'C18O':[6.20]},
                   '635':{'13CO':[7.41],'C18O':[8.18]},
                   '636':{'13CO':[9.72],'C18O':[9.72]},
                   '637':{'13CO':[10.38],'C18O':[10.49]},
                   '638':{'13CO':[11.04],'C18O':[11.04]},
                   '639':{'13CO':[10.93],'C18O':[11.48]},
                   '640':{'13CO':[9.83],'C18O':[7.08]},
                   '641':{'13CO':[8.],'C18O':[8.]},
                   '642':{'13CO':[8.29],'C18O':[8.40]},
                   '643':{'13CO':[7.08],'C18O':[6.97]},
                   '644':{'13CO':[8.84],'C18O':[8.84]},
                   '645':{'13CO':[11.15],'C18O':[11.37]},
                   '646':{'13CO':[11.15],'C18O':[11.04]},
                   '647':{'13CO':[8.],'C18O':[8.]},
                   '648':{'13CO':[10.49],'C18O':[11.04]},
                   '649':{'13CO':[8.95],'C18O':[8.73]},
                   '650':{'13CO':[8.],'C18O':[8.]},
                   '651':{'13CO':[10.71],'C18O':[6.42]},
                   '652':{'13CO':[11.26],'C18O':[11.37]},
                   '653':{'13CO':[7.08],'C18O':[6.86]},
                   '654':{'13CO':[8.73],'C18O':[8.51]},
                   '655':{'13CO':[8.40],'C18O':[8.18]},
                   '656':{'13CO':[8.29],'C18O':[8.18]},
                   '657':{'13CO':[7.85],'C18O':[7.85]},
                   '658':{'13CO':[11.04],'C18O':[15.99]},
                   '659':{'13CO':[10.38],'C18O':[0]},
                   '660':{'13CO':[10.71],'C18O':[10.71]},
                   '661':{'13CO':[8.],'C18O':[8.]},
                   '662':{'13CO':[8.],'C18O':[8.]},
                   '663':{'13CO':[10.27],'C18O':[10.49]},
                   '664':{'13CO':[5.98],'C18O':[5.87]},
                   '665':{'13CO':[8.73],'C18O':[11.37]},
                   '666':{'13CO':[8.29],'C18O':[8.18]},
                   '667':{'13CO':[7.63],'C18O':[7.19]},
                   '668':{'13CO':[8.40],'C18O':[8.40]},
                   '669':{'13CO':[8.],'C18O':[8.]},
                   '670':{'13CO':[6.97],'C18O':[6.97]},
                   '671':{'13CO':[11.48],'C18O':[11.81]},
                   '672':{'13CO':[7.96],'C18O':[8.73]},
                   '673':{'13CO':[10.16],'C18O':[3.67]},
                   '674':{'13CO':[10.93],'C18O':[9.06]},
                   '675':{'13CO':[8.],'C18O':[8.]},
                   '676':{'13CO':[8.],'C18O':[8.]},
                   '677':{'13CO':[9.17],'C18O':[7.96]},
                   '678':{'13CO':[8.51],'C18O':[7.96]},
                   '679':{'13CO':[6.20],'C18O':[6.09]},
                   '680':{'13CO':[10.93],'C18O':[11.59]},
                   '681':{'13CO':[8.],'C18O':[8.]},
                   '682':{'13CO':[10.82],'C18O':[8.40]},
                   '683':{'13CO':[8.],'C18O':[0]},
                   '684':{'13CO':[5.76],'C18O':[11.48]},
                   '685':{'13CO':[7.52],'C18O':[7.41]},
                   '686':{'13CO':[8.62],'C18O':[7.08]},
                   '687':{'13CO':[7.96],'C18O':[8.18]},
                   '688':{'13CO':[8.51],'C18O':[8.40]},
                   '689':{'13CO':[7.41],'C18O':[6.97]},
                   '690':{'13CO':[6.86],'C18O':[6.75]},
                   '691':{'13CO':[12.14],'C18O':[12.47]},
                   '692':{'13CO':[10.71],'C18O':[10.82]},
                   '693':{'13CO':[8.],'C18O':[8.]},
                   '694':{'13CO':[8.],'C18O':[8.]},
                   '695':{'13CO':[8.62],'C18O':[8.51]},
                   '696':{'13CO':[8.18],'C18O':[8.07]},
                   '697':{'13CO':[7.30],'C18O':[6.31]},
                   '698':{'13CO':[9.83],'C18O':[8.62]},
                   '699':{'13CO':[11.15],'C18O':[11.15]},
                   '700':{'13CO':[8.],'C18O':[8.]},
                   '701':{'13CO':[8.73],'C18O':[7.41]},
                   '702':{'13CO':[11.26],'C18O':[11.26]},
                   '703':{'13CO':[8.29],'C18O':[7.85]},
                   '704':{'13CO':[8.],'C18O':[0]},
                   '705':{'13CO':[7.74],'C18O':[7.19]},
                   '706':{'13CO':[5.54],'C18O':[5.65]},
                   '707':{'13CO':[8.51],'C18O':[7.19]},
                   '708':{'13CO':[8.40],'C18O':[8.51]},
                   '709':{'13CO':[7.30],'C18O':[7.30]},
                   '710':{'13CO':[8.62],'C18O':[8.62]},
                   '711':{'13CO':[10.60],'C18O':[10.49]},
                   '712':{'13CO':[8.],'C18O':[8.]},
                   '713':{'13CO':[8.62],'C18O':[5.98]},
                   '714':{'13CO':[8.],'C18O':[8.]},
                   '715':{'13CO':[8.84],'C18O':[11.48]},
                   '716':{'13CO':[8.],'C18O':[8.]},
                   '717':{'13CO':[11.15],'C18O':[12.36]},
                   '718':{'13CO':[8.],'C18O':[8.]},
                   '719':{'13CO':[8.],'C18O':[8.]},
                   '720':{'13CO':[8.07],'C18O':[8.18]},
                   '721':{'13CO':[8.07],'C18O':[7.96]},
                   '722':{'13CO':[7.41],'C18O':[7.41]},
                   '723':{'13CO':[10.60],'C18O':[0]},
                   '724':{'13CO':[10.27],'C18O':[10.16]},
                   '725':{'13CO':[10.49],'C18O':[10.49]},
                   '726':{'13CO':[10.71],'C18O':[10.93]},
                   '727':{'13CO':[8.],'C18O':[8.]},
                   '728':{'13CO':[7.96],'C18O':[3.45]},
                   '729':{'13CO':[11.26],'C18O':[8.62]},
                   '730':{'13CO':[6.42],'C18O':[6.31]},
                   '731':{'13CO':[8.62],'C18O':[6.75]},
                   '732':{'13CO':[9.17],'C18O':[9.06]},
                   '733':{'13CO':[5.98],'C18O':[6.20]},
                   '734':{'13CO':[7.19],'C18O':[7.19]},
                   '735':{'13CO':[8.62],'C18O':[7.74]},
                   '736':{'13CO':[10.71],'C18O':[10.82]},
                   '737':{'13CO':[10.05],'C18O':[0]},
                   '738':{'13CO':[10.16],'C18O':[10.27]},
                   '739':{'13CO':[10.93],'C18O':[11.04]},
                   '740':{'13CO':[5.98],'C18O':[9.61]},
                   '741':{'13CO':[4.00],'C18O':[9.28]},
                   '742':{'13CO':[6.53],'C18O':[6.42]},
                   '743':{'13CO':[6.97],'C18O':[6.97]},
                   '744':{'13CO':[8.84],'C18O':[8.84]},
                   '745':{'13CO':[6.75],'C18O':[6.86]},
                   '746':{'13CO':[7.19],'C18O':[6.53]},
                   '747':{'13CO':[9.17],'C18O':[8.95]},
                   '748':{'13CO':[7.96],'C18O':[8.07]},
                   '749':{'13CO':[8.73],'C18O':[8.84]},
                   '750':{'13CO':[8.29],'C18O':[8.40]},
                   '751':{'13CO':[8.],'C18O':[8.]},
                   '752':{'13CO':[9.28],'C18O':[0]},
                   '753':{'13CO':[9.06],'C18O':[9.17]},
                   '754':{'13CO':[9.06],'C18O':[7.74]},
                   '755':{'13CO':[8.29],'C18O':[8.95]},
                   '756':{'13CO':[8.],'C18O':[0]},
                   '757':{'13CO':[7.96],'C18O':[7.85]},
                   '758':{'13CO':[7.19],'C18O':[3.34]},
                   '759':{'13CO':[8.95],'C18O':[7.30]},
                   '760':{'13CO':[8.51],'C18O':[7.63]},
                   '761':{'13CO':[8.62],'C18O':[8.40]},
                   '762':{'13CO':[9.50],'C18O':[9.39]},
                   '763':{'13CO':[7.63],'C18O':[9.50]},
                   '764':{'13CO':[10.16],'C18O':[15.33]},
                   '765':{'13CO':[7.30],'C18O':[7.30]},
                   '766':{'13CO':[8.62],'C18O':[8.62]},
                   '767':{'13CO':[8.18],'C18O':[7.85]},
                   '768':{'13CO':[8.62],'C18O':[8.07]},
                   '769':{'13CO':[8.29],'C18O':[8.07]},
                   '770':{'13CO':[7.96],'C18O':[7.85]},
                   '771':{'13CO':[7.96],'C18O':[7.96]},
                   '772':{'13CO':[8.40],'C18O':[8.29]},
                   '773':{'13CO':[11.15],'C18O':[11.15]},
                   '774':{'13CO':[8.],'C18O':[8.]},
                   '775':{'13CO':[8.],'C18O':[8.]},
                   '776':{'13CO':[8.],'C18O':[8.]},
                   '777':{'13CO':[10.49],'C18O':[9.83]},
                   '778':{'13CO':[8.],'C18O':[0]},
                   '779':{'13CO':[8.18],'C18O':[8.95]},
                   '780':{'13CO':[6.31],'C18O':[5.65]},
                   '781':{'13CO':[6.53],'C18O':[6.42]},
                   '782':{'13CO':[6.86],'C18O':[6.64]},
                   '783':{'13CO':[9.06],'C18O':[8.29]},
                   '784':{'13CO':[8.73],'C18O':[8.84]},
                   '785':{'13CO':[7.85],'C18O':[7.63]},
                   '786':{'13CO':[0],'C18O':[0]},
                   '787':{'13CO':[8.51],'C18O':[8.40]},
                   '788':{'13CO':[7.41],'C18O':[7.52]},
                   '789':{'13CO':[11.15],'C18O':[10.05]},
                   '790':{'13CO':[11.70],'C18O':[11.81]},
                   '791':{'13CO':[11.26],'C18O':[9.72]},
                   '792':{'13CO':[8.84],'C18O':[10.82]},
                   '793':{'13CO':[8.84],'C18O':[5.87]},
                   '794':{'13CO':[10.82],'C18O':[9.83]},
                   '795':{'13CO':[10.16],'C18O':[10.27]},
                   '796':{'13CO':[11.15],'C18O':[11.26]},
                   '797':{'13CO':[8.],'C18O':[8.]},
                   '798':{'13CO':[9.06],'C18O':[7.74]},
                   '799':{'13CO':[10.38],'C18O':[10.49]},
                   '800':{'13CO':[7.19],'C18O':[0]},
                   '801':{'13CO':[8.],'C18O':[8.]},
                   '802':{'13CO':[8.],'C18O':[8.]},
                   '803':{'13CO':[8.51],'C18O':[8.62]},
                   '804':{'13CO':[8.62],'C18O':[8.18]},
                   '805':{'13CO':[6.97],'C18O':[8.95]},
                   '806':{'13CO':[11.37],'C18O':[6.75]},
                   '807':{'13CO':[10.60],'C18O':[9.28]},
                   '808':{'13CO':[0],'C18O':[0]},
                   '809':{'13CO':[6.64],'C18O':[6.64]},
                   '810':{'13CO':[8.29],'C18O':[8.18]},
                   '811':{'13CO':[7.85],'C18O':[7.96]},
                   '812':{'13CO':[9.39],'C18O':[8.95]},
                   '813':{'13CO':[9.72],'C18O':[9.83]},
                   '814':{'13CO':[8.18],'C18O':[7.96]},
                   '815':{'13CO':[8.51],'C18O':[8.29]},
                   '816':{'13CO':[9.28],'C18O':[8.95]},
                   '817':{'13CO':[9.61],'C18O':[9.39]},
                   '818':{'13CO':[10.71],'C18O':[8.07]},
                   '819':{'13CO':[8.],'C18O':[8.]},
                   '820':{'13CO':[10.93],'C18O':[11.04]},
                   '821':{'13CO':[10.93],'C18O':[13.68]},
                   '822':{'13CO':[8.],'C18O':[8.]},
                   '823':{'13CO':[7.41],'C18O':[7.63]},
                   '824':{'13CO':[6.09],'C18O':[5.65]},
                   '825':{'13CO':[7.96],'C18O':[5.54]},
                   '826':{'13CO':[8.73],'C18O':[8.73]},
                   '827':{'13CO':[7.74],'C18O':[7.7]},
                   '828':{'13CO':[8.29],'C18O':[9.06]},
                   '829':{'13CO':[9.28],'C18O':[8.40]},
                   '830':{'13CO':[6.53],'C18O':[6.31]},
                   '831':{'13CO':[6.75],'C18O':[6.42]},
                   '832':{'13CO':[8.51],'C18O':[8.40]},
                   '833':{'13CO':[11.37],'C18O':[11.59]},
                   '834':{'13CO':[10.49],'C18O':[10.49]},
                   '835':{'13CO':[8.07],'C18O':[8.18]},
                   '836':{'13CO':[0],'C18O':[0]},
                   '837':{'13CO':[8.],'C18O':[8.]},
                   '838':{'13CO':[10.93],'C18O':[10.93]},
                   '839':{'13CO':[9.61],'C18O':[10.71]},
                   '840':{'13CO':[6.09],'C18O':[0]},
                   '841':{'13CO':[5.87],'C18O':[5.87]},
                   '842':{'13CO':[7.96],'C18O':[7.85]},
                   '843':{'13CO':[7.74],'C18O':[7.41]},
                   '844':{'13CO':[8.73],'C18O':[9.39]},
                   '845':{'13CO':[10.27],'C18O':[0]},
                   '846':{'13CO':[10.71],'C18O':[8.95]},
                   '847':{'13CO':[8.62],'C18O':[8.40]},
                   '848':{'13CO':[9.17],'C18O':[6.64]},
                   '849':{'13CO':[0],'C18O':[0]},
                   '850':{'13CO':[12.14],'C18O':[8.84]},
                   '851':{'13CO':[10.05],'C18O':[9.94]},
                   '852':{'13CO':[6.75],'C18O':[8.73]},
                   '853':{'13CO':[8.],'C18O':[8.]},
                   '854':{'13CO':[7.96],'C18O':[8.07]},
                   '855':{'13CO':[6.64],'C18O':[6.75]},
                   '856':{'13CO':[8.95],'C18O':[6.75]},
                   '857':{'13CO':[8.18],'C18O':[8.40]},
                   '858':{'13CO':[7.85],'C18O':[7.63]},
                   '859':{'13CO':[7.74],'C18O':[7.74]},
                   '860':{'13CO':[8.40],'C18O':[8.18]},
                   '861':{'13CO':[9.06],'C18O':[9.06]},
                   '862':{'13CO':[10.38],'C18O':[8.18]},
                   '863':{'13CO':[8.],'C18O':[8.]},
                   '864':{'13CO':[8.],'C18O':[8.]},
                   '865':{'13CO':[6.20],'C18O':[6.09]},
                   '866':{'13CO':[7.30],'C18O':[6.53]},
                   '867':{'13CO':[6.42],'C18O':[6.20]},
                   '868':{'13CO':[8.95],'C18O':[8.40]},
                   '869':{'13CO':[6.53],'C18O':[6.42]},
                   '870':{'13CO':[8.],'C18O':[0]},
                   '871':{'13CO':[8.73],'C18O':[8.73]},
                   '872':{'13CO':[9.06],'C18O':[9.06]},
                   '873':{'13CO':[11.37],'C18O':[11.48]},
                   '874':{'13CO':[10.49],'C18O':[10.71]},
                   '875':{'13CO':[12.69],'C18O':[12.69]},
                   '876':{'13CO':[8.],'C18O':[8.]},
                   '877':{'13CO':[9.94],'C18O':[7.52]},
                   '878':{'13CO':[6.86],'C18O':[6.86]},
                   '879':{'13CO':[9.39],'C18O':[9.50]},
                   '880':{'13CO':[8.],'C18O':[8.]},
                   '881':{'13CO':[8.],'C18O':[8.]},
                   '882':{'13CO':[8.],'C18O':[8.]},
                   '883':{'13CO':[9.61],'C18O':[14.89]},
                   '884':{'13CO':[10.71],'C18O':[7.30]},
                   '885':{'13CO':[8.],'C18O':[8.]},
                   '886':{'13CO':[8.],'C18O':[8.]},
                   '887':{'13CO':[7.85],'C18O':[7.74]},
                   '888':{'13CO':[7.30],'C18O':[6.97]},
                   '889':{'13CO':[7.96],'C18O':[7.96]},
                   '890':{'13CO':[10.27],'C18O':[8.40]},
                   '891':{'13CO':[8.],'C18O':[8.]},
                   '892':{'13CO':[7.41],'C18O':[7.63]},
                   '893':{'13CO':[0],'C18O':[0]},
                   '894':{'13CO':[8.18],'C18O':[8.07]},
                   '895':{'13CO':[8.],'C18O':[8.]},
                   '896':{'13CO':[8.],'C18O':[8.]},
                   '897':{'13CO':[9.83],'C18O':[9.50]},
                   '898':{'13CO':[9.06],'C18O':[9.06]},
                   '899':{'13CO':[7.85],'C18O':[7.30]},
                   '900':{'13CO':[8.18],'C18O':[8.07]},
                   '901':{'13CO':[8.18],'C18O':[8.07]},
                   '902':{'13CO':[8.],'C18O':[8.]},
                   '903':{'13CO':[9.06],'C18O':[8.40]},
                   '904':{'13CO':[8.],'C18O':[8.]},
                   '905':{'13CO':[6.20],'C18O':[6.09]},
                   '906':{'13CO':[9.28],'C18O':[7.96]},
                   '907':{'13CO':[9.06],'C18O':[8.18]},
                   '908':{'13CO':[9.50],'C18O':[10.60]},
                   '909':{'13CO':[8.],'C18O':[8.]},
                   '910':{'13CO':[7.63],'C18O':[7.74]},
                   '911':{'13CO':[8.],'C18O':[8.]},
                   '912':{'13CO':[11.37],'C18O':[9.94]},
                   '913':{'13CO':[8.07],'C18O':[8.40]},
                   '914':{'13CO':[8.18],'C18O':[8.07]},
                   '915':{'13CO':[7.52],'C18O':[0]},
                   '916':{'13CO':[8.40],'C18O':[8.73]},
                   '917':{'13CO':[8.],'C18O':[8.]},
                   '918':{'13CO':[8.],'C18O':[8.]},
                   '919':{'13CO':[10.05],'C18O':[10.27]},
                  }

multiGaussDict = {
                  '6':{'13CO':[6.5,8.5],'C18O':[6.5,8.5]},
                  '8':{'13CO':[7,10],'C18O':[7]},
                  '15':{'13CO':[8,10],'C18O':[8,10]},
                  '24':{'13CO':[7,9],'C18O':[7,9]},
                  '28':{'13CO':[7,8],'C18O':[7,8]},
                  '29':{'13CO':[7.5,10],'C18O':[7.5,10]},
                  '41':{'13CO':[8,10],'C18O':[8,10]},
                  '43':{'13CO':[8,9.5],'C18O':[8,9.5]},
                  '45':{'13CO':[9.5,10.5],'C18O':[9.5,10.5]},
                  '53':{'13CO':[6.5,8.5],'C18O':[6.5,8.5]},
                  '54':{'13CO':[9,10.5],'C18O':[9,10.5]},
                  '59':{'13CO':[8,9,10],'C18O':[8]},
                  '61':{'13CO':[7,9.5],'C18O':[7]},
                  '65':{'13CO':[9,11],'C18O':[9,11]},
                  '70':{'13CO':[8],'C18O':[8]}, # outflow? # 13CO bad fit
                  '73':{'13CO':[8],'C18O':[8]}, # outflow?
                  '74':{'13CO':[7,8.5],'C18O':[7,8.5]},
                  '76':{'13CO':[7,10],'C18O':[7,10]},
                  '77':{'13CO':[11,13],'C18O':[11,13]},
                  '79':{'13CO':[6.5,8.5],'C18O':[6.5,8.5]},
                  '81':{'13CO':[7,10.5],'C18O':[7]},
                  '83':{'13CO':[11,13],'C18O':[11]}, # 13CO bad fit
                  '85':{'13CO':[7.5,9.5],'C18O':[7.5,9.5]},
                  '97':{'13CO':[7,8.5],'C18O':[7,8.5]},
                  '98':{'13CO':[8,10],'C18O':[8,10]},
                  '99':{'13CO':[6,8.5],'C18O':[8.5]},
                  '103':{'13CO':[8,10],'C18O':[8,10]},
                  '107':{'13CO':[8,9],'C18O':[8,9]},
                  '110':{'13CO':[11.2,13.2],'C18O':[11,13]}, # 13CO bad fit
                  '112':{'13CO':[6.5,8,9.5],'C18O':[6.5,8,9.5]},
                  '114':{'13CO':[8.5,11],'C18O':[8.5,11]},
                  '117':{'13CO':[9.1,10.5,13],'C18O':[10.5]}, # 13CO bad fit
                  '118':{'13CO':[7.5,8.5],'C18O':[7.5,8.5]},
                  '119':{'13CO':[6.5,10.5],'C18O':[6.5,10.5]},
                  '121':{'13CO':[7,8.5],'C18O':[8.5]},
                  '122':{'13CO':[7,10.5],'C18O':[7]},
                  '124':{'13CO':[8,11],'C18O':[8]},
                  '127':{'13CO':[9,10.5],'C18O':[9,10.5]},
                  '133':{'13CO':[6.5,8],'C18O':[6.3,7.9]},
                  '144':{'13CO':[9,11],'C18O':[9,11]},
                  '150':{'13CO':[6.5,10.5],'C18O':[6.5]},
                  '152':{'13CO':[7.5,10],'C18O':[7.5]},
                  '153':{'13CO':[7,8],'C18O':[7,8]},
                  '154':{'13CO':[8],'C18O':[8]}, # outflow? # C18O bad fit # 13CO bad fit
                  '159':{'13CO':[7.5,8.5],'C18O':[7,8.5]},
                  '160':{'13CO':[8,11.5],'C18O':[8]},
                  '165':{'13CO':[7.5,9.5],'C18O':[7.5,9.5]},
                  '168':{'13CO':[7,10],'C18O':[7]},
                  '169':{'13CO':[9,11],'C18O':[9,11]},
                  '172':{'13CO':[6.5,8.8,10.5],'C18O':[7]}, # 13CO bad fit
                  '173':{'13CO':[6.5,10],'C18O':[6.5]},
                  '174':{'13CO':[7.2,10.7],'C18O':[7,8]},
                  '175':{'13CO':[8,10],'C18O':[8,10]},
                  '180':{'13CO':[8.5,10.5],'C18O':[8.5,10.5]},
                  '182':{'13CO':[11,13],'C18O':[11,13]},
                  '183':{'13CO':[9.5,11],'C18O':[9.5,11]},
                  '187':{'13CO':[6.5,9,10.5],'C18O':[6.5]},
                  '188':{'13CO':[7,10],'C18O':[7]},
                  '194':{'13CO':[8,10],'C18O':[8]},
                  '195':{'13CO':[7.5,10.5],'C18O':[7.5,10.5]},
                  '196':{'13CO':[7.5,10],'C18O':[7.5,10]},
                  '198':{'13CO':[10.3,11.3,13],'C18O':[11]},
                  '199':{'13CO':[8,9,10],'C18O':[8]}, # 13CO bad fit
                  '200':{'13CO':[8,9],'C18O':[8,9]},
                  '203':{'13CO':[8.5,9.5,11],'C18O':[9,11]},
                  '207':{'13CO':[11,13],'C18O':[11,13]},
                  '208':{'13CO':[11,13],'C18O':[11,13]},
                  '209':{'13CO':[7,8.5],'C18O':[8.5]},
                  '216':{'13CO':[5,7],'C18O':[0]},
                  '217':{'13CO':[7.5,10],'C18O':[7.5]},
                  '218':{'13CO':[9,11.5],'C18O':[9]},
                  '219':{'13CO':[7.5,10.5],'C18O':[7.5]},
                  '220':{'13CO':[7,8,9],'C18O':[7,8,9]}, # 13CO bad fit
                  '223':{'13CO':[10.8,12.8],'C18O':[11]}, # 13CO bad fit
                  '226':{'13CO':[7,9],'C18O':[7,9]},
                  '227':{'13CO':[7.5,12],'C18O':[7.5]},
                  '235':{'13CO':[8,10],'C18O':[8,10]},
                  '237':{'13CO':[4,6],'C18O':[0]},
                  '238':{'13CO':[7,8.5],'C18O':[7,8.5]},
                  '240':{'13CO':[11.0,13.0],'C18O':[11]},
                  '241':{'13CO':[11,13],'C18O':[11,13]},
                  '244':{'13CO':[7,9],'C18O':[7,9]},
                  '248':{'13CO':[11],'C18O':[0]},
                  '251':{'13CO':[6,7,11],'C18O':[0]},
                  '252':{'13CO':[6.5,8.5],'C18O':[6.5]},
                  '254':{'13CO':[7,9.5],'C18O':[7,9.5]}, # C18O bad fit # 13CO bad fit
                  '255':{'13CO':[8,11],'C18O':[8]},
                  '258':{'13CO':[6.5,8,10],'C18O':[6.5,8]},
                  '264':{'13CO':[8,11],'C18O':[8]},
                  '265':{'13CO':[6.5,8],'C18O':[8]},
                  '267':{'13CO':[0],'C18O':[0]},
                  '268':{'13CO':[6,10],'C18O':[0]},
                  '272':{'13CO':[8.5,11.5],'C18O':[8.5,11.5]},
                  '274':{'13CO':[8,9],'C18O':[9]},
                  '275':{'13CO':[7,10],'C18O':[0]},
                  '276':{'13CO':[8,9.5],'C18O':[8,9.5]},
                  '277':{'13CO':[9],'C18O':[0]},
                  '279':{'13CO':[9,12],'C18O':[9]},
                  '282':{'13CO':[6,8,9],'C18O':[6,8,9]},
                  '284':{'13CO':[8,10],'C18O':[8]},
                  '285':{'13CO':[6,7,10],'C18O':[6,7]},
                  '286':{'13CO':[6.5,7.5,10.5],'C18O':[6.5,7.5]},
                  '287':{'13CO':[7,10],'C18O':[7]},
                  '294':{'13CO':[6,8],'C18O':[8]},
                  '297':{'13CO':[6,7.5,9],'C18O':[7.5]},
                  '298':{'13CO':[8.5,9.5],'C18O':[8.5,9.5]},
                  '310':{'13CO':[10.5,12],'C18O':[10.5]},
                  '312':{'13CO':[5,8,11],'C18O':[8]},
                  '315':{'13CO':[7,10],'C18O':[7]},
                  '316':{'13CO':[8.5,9.5],'C18O':[8.5,9.5]},
                  '317':{'13CO':[8,10],'C18O':[8,10]},
                  '320':{'13CO':[7,9],'C18O':[9]},
                  '326':{'13CO':[6,7.5,10.5],'C18O':[6,7.5]},
                  '334':{'13CO':[9.5,10.5],'C18O':[10.5]},
                  '337':{'13CO':[5.5,6.5,9],'C18O':[5.5,6.5,9]},
                  '338':{'13CO':[6.5,10.5],'C18O':[6.5]},
                  '339':{'13CO':[7,10.5],'C18O':[7]},
                  '340':{'13CO':[7,10,11],'C18O':[10,11]},
                  '343':{'13CO':[9,11.5],'C18O':[9,11.5]},
                  '344':{'13CO':[10,12],'C18O':[10,12]},
                  '348':{'13CO':[6,7,11],'C18O':[6,7]},
                  '352':{'13CO':[6,11],'C18O':[0]},
                  '357':{'13CO':[6,8.5],'C18O':[8.5]},
                  '358':{'13CO':[8,10.5],'C18O':[8]},
                  '361':{'13CO':[8,9],'C18O':[8,9]},
                  '362':{'13CO':[7,9],'C18O':[7,9]},
                  '363':{'13CO':[7,10],'C18O':[7]},
                  '364':{'13CO':[7,9],'C18O':[0]},
                  '368':{'13CO':[12,13],'C18O':[12]},
                  '370':{'13CO':[5.5,8.5],'C18O':[5.5,8.5]},
                  '371':{'13CO':[7,9],'C18O':[7.3,8.8]},
                  '372':{'13CO':[8.5,11],'C18O':[0]},
                  '373':{'13CO':[9,11],'C18O':[9]},
                  '376':{'13CO':[6,7,10.5],'C18O':[6,7,10.5]},
                  '377':{'13CO':[7,9],'C18O':[7]},
                  '379':{'13CO':[8,10],'C18O':[8]},
                  '384':{'13CO':[5,7],'C18O':[0]},
                  '385':{'13CO':[7,9],'C18O':[7,9]},
                  '386':{'13CO':[7.5,10],'C18O':[7.5]},
                  '387':{'13CO':[7,9],'C18O':[7,9]},
                  '388':{'13CO':[8.5,10],'C18O':[8.5,10]},
                  '389':{'13CO':[9,11],'C18O':[9,11]},
                  '394':{'13CO':[5,6.5],'C18O':[0]},
                  '395':{'13CO':[7.5,10.5,12.5],'C18O':[7.5]},
                  '397':{'13CO':[10,11.5],'C18O':[10,11.5]},
                  '398':{'13CO':[6,11],'C18O':[0]},
                  '401':{'13CO':[10.5,11.5],'C18O':[11]},
                  '403':{'13CO':[11,13],'C18O':[11,13]},
                  '405':{'13CO':[7,8,9],'C18O':[7,8,9]},
                  '407':{'13CO':[9.5,11],'C18O':[9.5,11]},
                  '410':{'13CO':[6.5,10.5],'C18O':[6.5]},
                  '411':{'13CO':[7,10.5],'C18O':[7]},
                  '412':{'13CO':[7,9],'C18O':[7,9]},
                  '413':{'13CO':[7,10],'C18O':[7,10]},
                  '419':{'13CO':[5,7],'C18O':[0]},
                  '420':{'13CO':[7,8.5],'C18O':[7,8.5]},
                  '421':{'13CO':[7,8.5],'C18O':[7,8.5]},
                  '424':{'13CO':[11.5,12.5],'C18O':[12.5]},
                  '427':{'13CO':[6,7],'C18O':[0]},
                  '431':{'13CO':[7,9],'C18O':[7,9]},
                  '433':{'13CO':[8,10],'C18O':[8]},
                  '437':{'13CO':[8,9],'C18O':[8,9]},
                  '438':{'13CO':[6,7,11],'C18O':[6,7]},
                  '439':{'13CO':[6.5,10],'C18O':[6.5]},
                  '441':{'13CO':[8,9],'C18O':[7,8,9]},
                  '443':{'13CO':[6,7.5,8.5],'C18O':[6,7.5,8.5]},
                  '444':{'13CO':[8,10],'C18O':[8]},
                  '445':{'13CO':[7,10],'C18O':[7]},
                  '447':{'13CO':[9.5,11.5],'C18O':[9.5,11.5]},
                  '454':{'13CO':[6,8,9.5],'C18O':[8,9.5]},
                  '455':{'13CO':[6,7,8.5],'C18O':[6,7,8.5]},
                  '456':{'13CO':[7,8.5,10],'C18O':[7,8.5]},
                  '458':{'13CO':[9.5,11.5],'C18O':[9.5]},
                  '459':{'13CO':[8,9,11.5],'C18O':[8,9]},
                  '460':{'13CO':[8,9,10.5],'C18O':[8,9,10.5]},
                  '464':{'13CO':[9.5,11,13],'C18O':[11,13]},
                  '467':{'13CO':[7,11],'C18O':[7]},
                  '468':{'13CO':[6,9],'C18O':[6,9]},
                  '469':{'13CO':[8,10],'C18O':[7.5]},
                  '470':{'13CO':[7,8.5,9.5],'C18O':[7,8.5,9.5]},
                  '478':{'13CO':[7,8.5],'C18O':[7,8.5]}, # C18O bad fit
                  '480':{'13CO':[8,10],'C18O':[8]},
                  '492':{'13CO':[7,8,9],'C18O':[8,9]},
                  '493':{'13CO':[6,8],'C18O':[6,8]},
                  '497':{'13CO':[9,10.5],'C18O':[9,10.5]},
                  '498':{'13CO':[7,10],'C18O':[10]},
                  '506':{'13CO':[6,8],'C18O':[6,8]},
                  '507':{'13CO':[8,10],'C18O':[8,10]},
                  '508':{'13CO':[6.5,8,9],'C18O':[6.5,8,9]},
                  '509':{'13CO':[6,8,11],'C18O':[6,8]},
                  '512':{'13CO':[6.5,8,10],'C18O':[6.5,8,10]},
                  '513':{'13CO':[6,8,9.5],'C18O':[6,8,9.5]},
                  '515':{'13CO':[7,9,11],'C18O':[0]},
                  '524':{'13CO':[7.5,9,11],'C18O':[7.5,9]},
                  '525':{'13CO':[7,8,9],'C18O':[7,8,9]},
                  '526':{'13CO':[9,11],'C18O':[9,11]},
                  '534':{'13CO':[6,7.5],'C18O':[6]},
                  '535':{'13CO':[7,8,9],'C18O':[7,8,9]},
                  '536':{'13CO':[6,8.5],'C18O':[8.5]},
                  '538':{'13CO':[7.5,9],'C18O':[7.5,9]},
                  '539':{'13CO':[7.5,12],'C18O':[7.5]},
                  '545':{'13CO':[11.0,12.8],'C18O':[11]},
                  '549':{'13CO':[7,8,11],'C18O':[7,8]},
                  '552':{'13CO':[7,10],'C18O':[7]},
                  '553':{'13CO':[7.5,8.5,12],'C18O':[0]},
                  '556':{'13CO':[6.5,9,11],'C18O':[6.5,9,11]},
                  '557':{'13CO':[7,9],'C18O':[7,9]},
                  '563':{'13CO':[7,10],'C18O':[7]},
                  '569':{'13CO':[5,7,9],'C18O':[7,9]},
                  '570':{'13CO':[6,8],'C18O':[8]},
                  '572':{'13CO':[8,9],'C18O':[8,9]},
                  '574':{'13CO':[6,12],'C18O':[6,12]},
                  '576':{'13CO':[8,12],'C18O':[0]},
                  '582':{'13CO':[7,10],'C18O':[0]},
                  '584':{'13CO':[5.8,7.5],'C18O':[7]}, # 13CO bad fit
                  '585':{'13CO':[7.5,11],'C18O':[7.5]},
                  '586':{'13CO':[8.2,10.1],'C18O':[8.0,8.9]}, # C18O bad fit # 13CO bad fit
                  '587':{'13CO':[3,9],'C18O':[3,9]},
                  '591':{'13CO':[6.5,8,10],'C18O':[6.5,8]},
                  '592':{'13CO':[5.5,7,8.5],'C18O':[5.5,7,8.5]}, # 13CO bad fit
                  '594':{'13CO':[8.5,9.5],'C18O':[8.5,9.5]},
                  '595':{'13CO':[8,9],'C18O':[8,9]},
                  '597':{'13CO':[9.5,10.5],'C18O':[9.5,10.5]},
                  '601':{'13CO':[8,9],'C18O':[8,9]},
                  '610':{'13CO':[6.5,8],'C18O':[8]},
                  '611':{'13CO':[8,10],'C18O':[7.8,9.5]},
                  '613':{'13CO':[8,10],'C18O':[8]},
                  '614':{'13CO':[6,8,11],'C18O':[6,8,11]},
                  '615':{'13CO':[6,11],'C18O':[6]},
                  '619':{'13CO':[6.5,8.5],'C18O':[0]},
                  '620':{'13CO':[6.5,10],'C18O':[6.5]},
                  '623':{'13CO':[8,9],'C18O':[8,9]},
                  '624':{'13CO':[8,10],'C18O':[8]},
                  '625':{'13CO':[10,11],'C18O':[0]},
                  '626':{'13CO':[3,9],'C18O':[0]},
                  '627':{'13CO':[7,11],'C18O':[0]},
                  '628':{'13CO':[7,9,12],'C18O':[0]},
                  '632':{'13CO':[7,8,9],'C18O':[7,8,9]},
                  '634':{'13CO':[6,13],'C18O':[6]},
                  '635':{'13CO':[7.5,8.5,13],'C18O':[0]},
                  '636':{'13CO':[8,10],'C18O':[8]},
                  '637':{'13CO':[8.5,10.5],'C18O':[8.5,10.5]},
                  '643':{'13CO':[7,8.5,10],'C18O':[7,8.5,10]},
                  '644':{'13CO':[9,12],'C18O':[9]},
                  '645':{'13CO':[7,11],'C18O':[7,11]},
                  '646':{'13CO':[11,13],'C18O':[11,13]},
                  '648':{'13CO':[9,11],'C18O':[11]},
                  '653':{'13CO':[6,7,10],'C18O':[6,7]},
                  '654':{'13CO':[6.5,8.5],'C18O':[6.5,8.5]},
                  '655':{'13CO':[6,8],'C18O':[6,8]},
                  '656':{'13CO':[6,8],'C18O':[6,8]},
                  '657':{'13CO':[7,8,10],'C18O':[7,8,10]},
                  '663':{'13CO':[6.5,8,9.5,10.5],'C18O':[9.5,10.5]},
                  '664':{'13CO':[6,8,10],'C18O':[6,8]},
                  '665':{'13CO':[6.5,9],'C18O':[9]},
                  '666':{'13CO':[6,8.5],'C18O':[8.5]},
                  '670':{'13CO':[7,8,10],'C18O':[7]},
                  '671':{'13CO':[9,12],'C18O':[12]},
                  '676':{'13CO':[5,7],'C18O':[0]},
                  '677':{'13CO':[8,9.5],'C18O':[8]},
                  '678':{'13CO':[6.5,8],'C18O':[8]},
                  '680':{'13CO':[11,13],'C18O':[11]},
                  '684':{'13CO':[5,7],'C18O':[0]},
                  '685':{'13CO':[6,7.5,11],'C18O':[6,7.5]},
                  '686':{'13CO':[7.0,8.8,9.9],'C18O':[7.1,8.8]}, # C18O bad fit
                  '688':{'13CO':[7,8.5],'C18O':[8.5]},
                  '689':{'13CO':[7,10],'C18O':[7]},
                  '690':{'13CO':[7,13],'C18O':[7]},
                  '691':{'13CO':[10,12],'C18O':[10,12]},
                  '695':{'13CO':[7,8.5],'C18O':[8.5]},
                  '696':{'13CO':[7,8],'C18O':[8]},
                  '697':{'13CO':[7,10],'C18O':[7]},
                  '701':{'13CO':[7.5,8.5,10],'C18O':[8]},
                  '705':{'13CO':[6,7.5],'C18O':[7.5]},
                  '706':{'13CO':[6,7,9],'C18O':[6]},
                  '707':{'13CO':[7,8.5,10],'C18O':[7.1,8.6]},
                  '710':{'13CO':[6,8.5],'C18O':[8.5]},
                  '711':{'13CO':[10.5,11.5],'C18O':[10.5]},
                  '719':{'13CO':[6,7],'C18O':[0]},
                  '720':{'13CO':[6,8],'C18O':[6,8]},
                  '721':{'13CO':[7.9,9.5],'C18O':[7.9,9.5]}, # 13CO bad fit
                  '730':{'13CO':[6.5,8,10],'C18O':[6.5,8,10]},
                  '731':{'13CO':[7,9],'C18O':[7,9]},
                  '732':{'13CO':[7,8,9],'C18O':[8,9]},
                  '733':{'13CO':[6,7],'C18O':[6,7]},
                  '734':{'13CO':[7,9],'C18O':[7,8.5]},
                  '736':{'13CO':[9,11],'C18O':[9,11]},
                  '738':{'13CO':[8.5,10.5],'C18O':[10.5]},
                  '740':{'13CO':[4,6],'C18O':[0]},
                  '741':{'13CO':[4,6],'C18O':[0]},
                  '742':{'13CO':[6.5,10],'C18O':[6.5,10]},
                  '743':{'13CO':[7,9],'C18O':[7,9]},
                  '745':{'13CO':[7,10],'C18O':[7]},
                  '746':{'13CO':[7,10],'C18O':[7]},
                  '747':{'13CO':[6,9],'C18O':[9]},
                  '749':{'13CO':[7,8,9],'C18O':[9]},
                  '750':{'13CO':[7,8.5,11],'C18O':[7,8.5]},
                  '753':{'13CO':[7,8.5,9.5],'C18O':[8.5,9.5]},
                  '754':{'13CO':[5,7,8,9],'C18O':[8,9]},
                  '757':{'13CO':[7,8],'C18O':[0]},
                  '758':{'13CO':[7,11.5],'C18O':[0]},
                  '760':{'13CO':[7.5,8.5],'C18O':[7.5,8.5]},
                  '761':{'13CO':[8.5,12],'C18O':[8.5]},
                  '765':{'13CO':[7,11],'C18O':[7]},
                  '766':{'13CO':[6.5,8.5],'C18O':[8.5]},
                  '767':{'13CO':[8,9.5],'C18O':[8]},
                  '769':{'13CO':[8.5,10.5],'C18O':[8.5]},
                  '770':{'13CO':[8,10],'C18O':[8]},
                  '772':{'13CO':[8,10],'C18O':[8,10]},
                  '779':{'13CO':[7,8,9],'C18O':[7,8,9]},
                  '782':{'13CO':[6.5,7.5],'C18O':[6.5,7.5]},
                  '783':{'13CO':[6,9],'C18O':[9]},
                  '785':{'13CO':[8,10],'C18O':[8,10]},
                  '787':{'13CO':[5,8],'C18O':[5,8]},
                  '788':{'13CO':[7,12],'C18O':[7]},
                  '789':{'13CO':[7,9,11],'C18O':[11]},
                  '792':{'13CO':[6.5,8.5],'C18O':[0]},
                  '793':{'13CO':[6,7,8.5],'C18O':[6,7,8.5]},
                  '794':{'13CO':[7,8.5,11,14],'C18O':[0]},
                  '797':{'13CO':[6,8],'C18O':[0]},
                  '798':{'13CO':[6.5,8,9],'C18O':[6.5,8,9]},
                  '804':{'13CO':[6,8],'C18O':[6,8]},
                  '809':{'13CO':[7,9],'C18O':[7]},
                  '810':{'13CO':[7,8],'C18O':[8]},
                  '811':{'13CO':[8,9.5],'C18O':[8]},
                  '814':{'13CO':[8,10],'C18O':[8]},
                  '823':{'13CO':[6,7.5],'C18O':[7.5]},
                  '824':{'13CO':[6,7.5,11],'C18O':[6,7.5]},
                  '825':{'13CO':[6,8,10],'C18O':[6,8,10]},
                  '826':{'13CO':[7,9],'C18O':[9]},
                  '828':{'13CO':[8,10],'C18O':[0]},
                  '831':{'13CO':[6.5,8,10.5],'C18O':[6.5,8]},
                  '835':{'13CO':[8,9.5],'C18O':[8,9.5]},
                  '841':{'13CO':[6,7.5,9,10.5],'C18O':[6]},
                  '847':{'13CO':[6,8.5],'C18O':[8.5]},
                  '848':{'13CO':[6.5,9],'C18O':[6.5,9]},
                  '850':{'13CO':[6,9,12],'C18O':[0]},
                  '854':{'13CO':[8,9],'C18O':[8]},
                  '855':{'13CO':[7,9],'C18O':[7]},
                  '856':{'13CO':[7,8,9],'C18O':[7,8,9]},
                  '859':{'13CO':[8,10],'C18O':[8]},
                  '861':{'13CO':[8,9],'C18O':[8,9]},
                  '862':{'13CO':[8,11],'C18O':[8,11]},
                  '866':{'13CO':[7,10.5],'C18O':[7]},
                  '867':{'13CO':[6.5,9],'C18O':[6.5]},
                  '869':{'13CO':[6.5,8,10],'C18O':[6.5]},
                  '871':{'13CO':[7,9],'C18O':[7,9]},
                  '878':{'13CO':[6.5,7.5],'C18O':[6.5,7.5]},
                  '879':{'13CO':[8,9.5],'C18O':[8,9.5]},
                  '887':{'13CO':[6.5,7.5],'C18O':[6.5,7.5]},
                  '888':{'13CO':[7,8.5],'C18O':[7,8.5]},
                  '889':{'13CO':[8,10],'C18O':[8]},
                  '898':{'13CO':[8,9],'C18O':[8,9]},
                  '899':{'13CO':[8,10],'C18O':[8]},
                  '900':{'13CO':[6.5,8],'C18O':[8]},
                  '901':{'13CO':[8,10],'C18O':[8,10]},
                  '905':{'13CO':[6,7,8],'C18O':[6]},
                  '906':{'13CO':[7,8,9],'C18O':[8,9]},
                  '907':{'13CO':[8,9,10],'C18O':[8]},
                  '913':{'13CO':[8,9.5],'C18O':[8,9.5]},
                  '914':{'13CO':[6.5,8],'C18O':[8]},
                  '916':{'13CO':[6.5,8.5],'C18O':[8.5]},
                  '917':{'13CO':[9,10.5],'C18O':[0]},
                  '919':{'13CO':[9,10.5],'C18O':[9,10.5]},
                  }

linenames = [r'$\rm ^{12}CO(1$-$0)$',r'$\rm ^{13}CO(1$-$0)$',r'$\rm C^{18}O(1$-$0)$']
molnames = ['12CO','13CO','C18O']
xpanels = 1
ypanels = len(lines)
xpanelwidth = 12
ypanelwidth = 5
vlow = 1 # if using Alyssa 13CO and C18O cubes, this should not be 0 because the first channel after 0 is empty
vhigh = 16
cols = len(corenames)
corevelocities = [[],[],[]]
coremom0s = [[],[],[]]
coremom1s = [[],[],[]]
coremom2s = [[],[],[]]
nh3velocities = [[]]
nh3evelocities = [[]]
coresnr = [[],[],[]]
coregaus_x0 = [[],[],[]]
coregaus_ex0 = [[],[],[]]
coregaus_sigma = [[],[],[]]
coregaus_esigma = [[],[],[]]
os.system('rm corespectra/Lane/averspec_Lane_core*.pdf')
os.system('rm corespectra/Lane_datapoints/12CO/Lanecore_core*.txt')
os.system('rm corespectra/Lane_datapoints/13CO/Lanecore_core*.txt')
os.system('rm corespectra/Lane_datapoints/C18O/Lanecore_core*.txt')
#os.system('rm corespectra/Lane/averspec_Lane_core_all0p25channel_core*.pdf')
#os.system('rm corespectra/Lane/single_averspec_Lane_core_all0p25channel_core*.pdf')
#os.system('rm corespectra/Lane_datapoints/12CO/Lanecore_all0p25channel_core*.txt')
#os.system('rm corespectra/Lane_datapoints/13CO/Lanecore_all0p25channel_core*.txt')
#os.system('rm corespectra/Lane_datapoints/C18O/Lanecore_all0p25channel_core*.txt')
for cc in range(cols):
    #if str(int(corenames[cc])) not in multiGaussDict.keys(): continue
    fig=plt.figure(figsize=(xpanelwidth*xpanels*1.1,ypanelwidth*ypanels/1.1))
    #plt.subplots_adjust(wspace=0.001,hspace=0.001)
    #pdfname='corespectra/Lane/single_averspec_Lane_core_all0p25channel_core'+str(int(corenames[cc]))+'.pdf'
    pdfname='corespectra/Lane/averspec_Lane_core'+str(int(corenames[cc]))+'.pdf'
    #pdfname='corespectra/Lane/averspec_Lane_core_all0p25channel_core'+str(int(corenames[cc]))+'.pdf'
    datafiles = {}
    #print 'x,y',x,y
    ccnh3xx = int(nh3xx[cc])
    ccnh3yy = int(nh3yy[cc])
    try:
        ccvlsr = [nh3data[ccnh3yy,ccnh3xx]]
        ccevlsr = [enh3data[ccnh3yy,ccnh3xx]]
    except:
        ccvlsr = [-100]
        ccevlsr = [-100]
    print 'core',corenames[cc],'ccnh3xx,ccnh3yy',ccnh3xx,ccnh3yy,'ccvlsr',ccvlsr,'ccevlsr',ccevlsr
    nh3velocities[0].append(ccvlsr[0])
    nh3evelocities[0].append(ccevlsr[0])
    ccvlsrstyle = ['dashed']
    for i in range(0,xpanels):
        for j in range(0,ypanels):
            print lines[j]
            panel = i+j*xpanels+1
            print 'panel',panel 
            bmaj,bmin,bpa = linebeams[panel-1]
            xx = linexx[panel-1]
            yy = lineyy[panel-1]
            corecenter = [int(xx[cc]),int(yy[cc])]
            #pixlist = beampixel(bmaj,bmin,bpa+90.,corecenter,cellsize,beamfraction=1.)
            pixlist = beampixel(cmaj[cc],cmin[cc],cpa[cc],corecenter,cellsize,beamfraction=1.)
            bigpixlist = beampixel(2.*cmaj[cc],2.*cmin[cc],cpa[cc],corecenter,cellsize,beamfraction=1.)
            annuluslist = list(set(bigpixlist)-set(pixlist))
            corei = np.array(pixlist) 
            annulus = np.array(annuluslist) 
            data = linedata[panel-1] 
            ### see if core pixels out of bound
            if np.any(corei[:,0]<0) or np.any(corei[:,0]>=len(data[0,0,:])) or np.any(corei[:,1]<0) or np.any(corei[:,1]>=len(data[0,:,0])) or np.any(annulus[:,0]<0) or np.any(annulus[:,0]>=len(data[0,0,:])) or np.any(annulus[:,1]<0) or np.any(annulus[:,1]>=len(data[0,:,0])):
                corevelocities[panel-1].append(-100)
                coresnr[panel-1].append(0)
                coremom0s[panel-1].append(-100)
                coremom1s[panel-1].append(-100)
                coremom2s[panel-1].append(-100)
                coregaus_x0[panel-1].append(-100)
                coregaus_ex0[panel-1].append(-100)
                coregaus_sigma[panel-1].append(-100)
                coregaus_esigma[panel-1].append(-100)
                continue
            temp = data[:,corei[:,1],corei[:,0]] 
            annulus_temp = data[:,annulus[:,1],annulus[:,0]] 
            rawspectrum = np.nanmean(temp,axis=(1))
            ### see if nan spectrum
            if sum(np.isnan(rawspectrum)) == len(rawspectrum):
                corevelocities[panel-1].append(-100)
                coresnr[panel-1].append(0)
                coremom0s[panel-1].append(-100)
                coremom1s[panel-1].append(-100)
                coremom2s[panel-1].append(-100)
                coregaus_x0[panel-1].append(-100)
                coregaus_ex0[panel-1].append(-100)
                coregaus_sigma[panel-1].append(-100)
                coregaus_esigma[panel-1].append(-100)
                continue
            annulus_spectrum = np.nanmean(annulus_temp,axis=(1))
            crval3, cdelt3, crpix3, n1 = line3rdaxis[panel-1]
            rawvelocity = np.array([(crval3+cdelt3*((ii+1)-crpix3))/1.e3 for ii in range(n1)]) # should not use i, it will confuse with the for i above
            subvel = (rawvelocity > vlow + 1) & (rawvelocity < vhigh - 0.5) 
            rawintens = rawspectrum[subvel]
            annulus_intens = annulus_spectrum[subvel]
            velocity = rawvelocity[subvel]
            coresavetxtarr = np.stack((velocity,rawintens),axis=1)
            #np.savetxt('corespectra/Lane_datapoints/'+molnames[j]+'/Lanecore_all0p25channel_core'+str(int(corenames[cc]))+'_'+molnames[j]+'.txt',coresavetxtarr,fmt='%7.2f %10.2e')
            np.savetxt('corespectra/Lane_datapoints/'+molnames[j]+'/Lanecore_core'+str(int(corenames[cc]))+'_'+molnames[j]+'.txt',coresavetxtarr,fmt='%7.2f %10.2e')
            coremom0 = mom0(cdelt3/1.e3,rawintens)
            coremom0s[panel-1].append(coremom0)
            havefit = 0
            velocityguess = []
            if j > 0:
                if str(int(corenames[cc])) in multiGaussDict.keys():
                    if 0 not in multiGaussDict[str(int(corenames[cc]))][molnames[j]]:
                        havefit = 1
                        guess = []
                        for ii in multiGaussDict[str(int(corenames[cc]))][molnames[j]]:
                            guess += [ii,0.2,0.2]
                            velocityguess += [ii]
                        popt, pcov = curve_fit(multigaus, velocity, rawintens, p0=guess, maxfev=100000)
                        perr = np.sqrt(np.diag(pcov))
                        component_number = len(multiGaussDict[str(int(corenames[cc]))][molnames[j]])
                        component_velocities = [abs(popt[ii*3]-ccvlsr[0]) for ii in range(component_number)]
                        closest_index = np.argmin(component_velocities)
                        closest_velocity = popt[closest_index*3]
                        closest_evelocity = perr[closest_index*3]
                        closest_sigma = popt[closest_index*3+2]
                        closest_esigma = perr[closest_index*3+2]
                        coregaus_x0[panel-1].append(closest_velocity)
                        coregaus_ex0[panel-1].append(closest_evelocity)
                        coregaus_sigma[panel-1].append(closest_sigma)
                        coregaus_esigma[panel-1].append(closest_esigma)
                else:
                    if 0 not in singleGaussDict[str(int(corenames[cc]))][molnames[j]]:
                        havefit = 1
                        guess = []
                        for ii in singleGaussDict[str(int(corenames[cc]))][molnames[j]]:
                            guess += [ii,0.5,0.5]
                            velocityguess += [ii]
                        try:
                            popt, pcov = curve_fit(multigaus, velocity, rawintens, p0=guess, maxfev=100000)
                            perr = np.sqrt(np.diag(pcov))
                            closest_velocity = popt[0]
                            closest_evelocity = perr[0]
                            closest_sigma = popt[2]
                            closest_esigma = perr[2]
                            coregaus_x0[panel-1].append(closest_velocity)
                            coregaus_ex0[panel-1].append(closest_evelocity)
                            coregaus_sigma[panel-1].append(closest_sigma)
                            coregaus_esigma[panel-1].append(closest_esigma)
                        except:
                            coregaus_x0[panel-1].append(-100)
                            coregaus_ex0[panel-1].append(-100)
                            coregaus_sigma[panel-1].append(-100)
                            coregaus_esigma[panel-1].append(-100)
            datarms = linerms[panel-1]
            #threshold = datarms*5.
            threshold = datarms / (cmaj[cc]*cmin[cc]/bmaj/bmin)**0.5 * 5.
            try:
                coremom1 = mom1(velocity,rawintens,threshold)
                coremom1s[panel-1].append(coremom1)
            except:
                coremom1s[panel-1].append(-100)
            try:
                coremom2 = mom2(velocity,rawintens,threshold)
                coremom2s[panel-1].append(coremom2)
            except:
                coremom2s[panel-1].append(-100)
            print 'coremom2',lines[j],coremom2
            try:
                peakind = np.nanargmax(rawintens)
            except:
                corevelocities[panel-1].append(-100)
                coresnr[panel-1].append(0)
                continue
            corevelocities[panel-1].append(velocity[peakind])
            #snr = rawintens[peakind]/datarms
            snr = rawintens[peakind]/(datarms / (cmaj[cc]*cmin[cc]/bmaj/bmin)**0.5)
            coresnr[panel-1].append(snr)
            ymin = 0
            ymax = 0
            if np.nanmin(rawintens) < ymin: ymin = np.nanmin(rawintens)
            if np.nanmax(rawintens) > ymax: ymax = np.nanmax(rawintens)
            datafiles['panel'+str(panel)] = {'title':linenames[j],'lines':{'1':{'x':velocity,'y':rawintens,'peakvelocity':velocity[peakind],'peaksnr':snr,'legends':'core','linestyles':'k-','drawsty':'steps-mid'},'2':{'x':velocity,'y':annulus_intens,'peakvelocity':-100,'peaksnr':0,'legends':'annulus','linestyles':'k:','drawsty':'steps-mid'},},'xlim':[vlow,vhigh],'ylim':[ymin-(ymax-ymin)/10.,ymax+(ymax-ymin)/10.],'xscale':'linear','yscale':'linear','xlabel':r'$v_{\rm LSR}~\rm (km~s^{-1})$','ylabel':r'$T_{\rm mb}~\rm (K)$','text':'','vertlines':[ccvlsr[0],coremom1]+velocityguess,'vertlinestyles':[ccvlsrstyle[0],'dotted']+['solid' for ii in velocityguess],'vertlinecolors':['b','b']+['g' for ii in velocityguess],'vertlinewidths':[4,2]+[1 for ii in velocityguess],'vertlinelengths':[0.5,0.6]+[0.3 for ii in velocityguess]}
            if j > 0 and havefit == 1:
                datafiles['panel'+str(panel)]['lines']['3']={'x':velocity,'y':multigaus(velocity,*popt),'legends':'Guess: '+str(velocityguess),'linestyles':'g-','drawsty':'default'}
                #datafiles['panel'+str(panel)]['vertlines'].append(closest_velocity)
                #datafiles['panel'+str(panel)]['vertlinestyles'].append('dashed')
                #datafiles['panel'+str(panel)]['vertlinecolors'].append('g')
                #datafiles['panel'+str(panel)]['vertlinewidths'].append(4)
                #datafiles['panel'+str(panel)]['vertlinelengths'].append(0.7)
    if datafiles == {}: continue
    for i in range(0,xpanels):
        for j in range(0,ypanels):
            panelnum = i+j*xpanels+1
            ax = fig.add_subplot(ypanels,xpanels,panelnum)
            if 'panel'+str(panelnum) not in datafiles.keys(): continue
            ax.set_xscale(datafiles['panel'+str(panelnum)]['xscale']) 
            ax.set_yscale(datafiles['panel'+str(panelnum)]['yscale']) 
            if datafiles['panel'+str(panelnum)]['ylim'] != []:
                ydown = datafiles['panel'+str(panelnum)]['ylim'][0]
                yup   = datafiles['panel'+str(panelnum)]['ylim'][1]
                ax.set_ylim(ydown,yup)
            else:
                ydown,yup = ax.get_ylim()
            for datafilenum in range(len(datafiles['panel'+str(panelnum)]['lines'].keys())): 
                x = datafiles['panel'+str(panelnum)]['lines'][str(datafilenum+1)]['x']
                y = datafiles['panel'+str(panelnum)]['lines'][str(datafilenum+1)]['y']
                linestyle = datafiles['panel'+str(panelnum)]['lines'][str(datafilenum+1)]['linestyles']
                legend = datafiles['panel'+str(panelnum)]['lines'][str(datafilenum+1)]['legends']
                drawsty = datafiles['panel'+str(panelnum)]['lines'][str(datafilenum+1)]['drawsty']
                ax.plot(x,y,linestyle,label=legend,drawstyle=drawsty)
                if 'peakvelocity' in datafiles['panel'+str(panelnum)]['lines'][str(datafilenum+1)].keys():
                    peakvelocity = datafiles['panel'+str(panelnum)]['lines'][str(datafilenum+1)]['peakvelocity']
                    peaksnr = datafiles['panel'+str(panelnum)]['lines'][str(datafilenum+1)]['peaksnr']
                    ax.vlines(peakvelocity,ydown,yup,linestyle='dotted')
                    #ax.text(peakvelocity+0.8, yup*0.9, '%.1f' % peakvelocity + ',' + '%.1f' % peaksnr,horizontalalignment='left',verticalalignment='center',fontsize=12)
            ax.legend(frameon=False,prop={'size':14},labelspacing=0.1) 
            if j == 0:
                ax.set_title('core'+str(int(corenames[cc])))
            ax.text(0.05, 0.9,datafiles['panel'+str(panelnum)]['title'],horizontalalignment='left',verticalalignment='center',transform = ax.transAxes,fontsize=12)
            #ax.text(0.1, 0.9,datafiles['panel'+str(panelnum)]['title']+' '+datafiles['panel'+str(panelnum)]['text'],horizontalalignment='left',verticalalignment='center',transform = ax.transAxes,fontsize=12)
            ax.text(0.04, 0.9,'('+str(int(corenames[cc]))+lletter[j]+')',horizontalalignment='right',verticalalignment='center',transform = ax.transAxes,fontsize=12)
            if datafiles['panel'+str(panelnum)]['xlim'] != []:
                ax.set_xlim(datafiles['panel'+str(panelnum)]['xlim'][0],datafiles['panel'+str(panelnum)]['xlim'][1])
                ax.hlines(0,datafiles['panel'+str(panelnum)]['xlim'][0],datafiles['panel'+str(panelnum)]['xlim'][1],linestyle='dotted')
            xlabel = datafiles['panel'+str(panelnum)]['xlabel']
            ylabel = datafiles['panel'+str(panelnum)]['ylabel']
            ax.set_xticks(np.arange(datafiles['panel'+str(panelnum)]['xlim'][0],datafiles['panel'+str(panelnum)]['xlim'][1],0.1),minor=True)
            vertlinex = datafiles['panel'+str(panelnum)]['vertlines']
            vertlinexstyles = datafiles['panel'+str(panelnum)]['vertlinestyles']
            vertlinexwidths = datafiles['panel'+str(panelnum)]['vertlinewidths']
            vertlinexlengths = datafiles['panel'+str(panelnum)]['vertlinelengths']
            vertlinexcolors = datafiles['panel'+str(panelnum)]['vertlinecolors']
            for nn,vl in enumerate(vertlinex):
                ax.vlines(vl,ydown,yup*vertlinexlengths[nn],linestyles=vertlinexstyles[nn],colors=vertlinexcolors[nn],linewidths=vertlinexwidths[nn])
            if j != ypanels-1:
                ax.set_yticks(ax.get_yticks()[1:])
                #ax.set_xticklabels(ax.get_xlabel(),visible=False)
            else: 
                ax.set_xlabel(xlabel)
            if i != 0:
                ax.set_yticklabels(ax.get_ylabel(),visible=False) 
                ax.set_xticks(ax.get_xticks()[1:]) 
            else: 
                ax.set_ylabel(ylabel)
            
    os.system('rm '+pdfname)
    plt.savefig(pdfname,bbox_inches='tight')
    plt.close(fig)
    #os.system('open '+pdfname)
    #os.system('cp '+pdfname+os.path.expandvars(' ${DROPATH}/highres'))
#savetxtarr = np.stack((corenames,xw,yw,corevelocities[0],coresnr[0],coremom0s[0],coremom1s[0],coremom2s[0],corevelocities[1],coresnr[1],coremom0s[1],coremom1s[1],coremom2s[1],corevelocities[2],coresnr[2],coremom0s[2],coremom1s[2],coremom2s[2],nh3velocities[0],nh3evelocities[0],coregaus_x0[1],coregaus_ex0[1],coregaus_sigma[1],coregaus_esigma[1],coregaus_x0[2],coregaus_ex0[2],coregaus_sigma[2],coregaus_esigma[2]),axis=1)
#np.savetxt('Lanecores_velocities.txt',savetxtarr,fmt='%3d %10.5f %10.5f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f')
#np.savetxt('Lanecores_all0p25channel_velocities.txt',savetxtarr,fmt='%3d %10.5f %10.5f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f %7.2f')





